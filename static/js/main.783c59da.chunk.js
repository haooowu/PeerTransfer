(this["webpackJsonppeer-transfer"]=this["webpackJsonppeer-transfer"]||[]).push([[0],{137:function(e,n,t){},151:function(e,n,t){},153:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(18),c=t.n(o),i=(t(137),t(9)),s=t(17),l=t(12),u=t(80);t(155),t(138),t(141);u.a.initializeApp({apiKey:"AIzaSyBeFSn6EPYfSzFt6BhqeM-33Vd96NdT33Q",authDomain:"peertransfer-44201.firebaseapp.com",databaseURL:"https://peertransfer-44201-default-rtdb.firebaseio.com",projectId:"peertransfer-44201",storageBucket:"peertransfer-44201.appspot.com",messagingSenderId:"640914820360",appId:"1:640914820360:web:51564296511922d704f0bd"});var d,p,b,f,h,j,m,O,g,x,w,v,y,C,k=u.a,D=t(11),I=[],R=function(){for(var e,n=128512;n<=128591;n+=1)I.push(String.fromCodePoint(n));var t=Math.floor(Math.random()*I.length);return e=I[t],I.splice(t,1),e},S=t(91),T=function(){var e=S.parse(window.navigator.userAgent);return{browser:e.browser.name||"unknown",platform:e.platform.type||"unknown"}},A=t(215),P=t.p+"static/media/backgroundRipple.48d86bdf.svg",E=t(113),F=t(19),M=t(218),z={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},L="transferRooms",B="connections",_="calleeCandidates",N="callerCandidates",U="fileMetas",W="dataChannelTimeout",H="waitRemoteDesc",$="publicID",J="appTheme",G="appAutoAccept",Y="appAutoDownload",X=16777216,q="public-id",K="public-id-wrapper",Q=t(4),V=a.a.createContext({localID:"",publicID:"",setPublicID:function(){}}),Z=function(e){var n=e.children,t=a.a.useState(""),o=Object(s.a)(t,2),c=o[0],i=o[1],l=a.a.useState(""),u=Object(s.a)(l,2),d=u[0],p=u[1];return Object(r.useEffect)((function(){var e,n,t=new RTCPeerConnection(z);n=t.createDataChannel(""),t.createOffer().then((function(e){var n;return null===(n=t)||void 0===n?void 0:n.setLocalDescription(e)}));var r=sessionStorage.getItem($);t.onicecandidate=function(a){var o;if(!a||!a.candidate||!a.candidate.candidate)return n&&n.close(),n=null,null===(o=t)||void 0===o||o.close(),void(t=null);var c=a.candidate.candidate.split(" ");if("host"!==c[7]){if(r)return void p(r);e||p(btoa(c[4])),e=c[4]}},k.auth().signInAnonymously().then((function(){return i(Object(M.a)())})).catch((function(){return F.b.error("Failed to connect to firebase, please check your internet connection and try again")}))}),[]),Object(Q.jsx)(V.Provider,{value:{localID:c,publicID:d,setPublicID:p},children:n})},ee=t(15),ne=t.n(ee),te=t(21),re="768px",ae="1200px",oe={xs:"max-width: ".concat("320px"),sm:"max-width: ".concat(re),lg:"max-width: ".concat(ae)},ce=D.b.div(d||(d=Object(l.a)(["\n  .peerHolder {\n    border-radius: 50%;\n    width: 64px;\n    height: 64px;\n    position: absolute;\n    z-index: 1;\n    @media only screen and (",") {\n      position: relative;\n      bottom: unset !important;\n      left: unset !important;\n      right: unset !important;\n      transform: unset !important;\n      margin-left: auto;\n      margin-right: auto;\n      margin-bottom: 3em;\n    }\n  }\n  & .peerHolder:nth-child(1) {\n    bottom: 33%;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n  & .peerHolder:nth-child(2) {\n    bottom: 20%;\n    left: 30%;\n  }\n  & .peerHolder:nth-child(3) {\n    bottom: 20%;\n    right: 30%;\n  }\n  & .peerHolder:nth-child(4) {\n    bottom: 58%;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n  & .peerHolder:nth-child(5) {\n    bottom: 30%;\n    left: 20%;\n  }\n  & .peerHolder:nth-child(6) {\n    bottom: 30%;\n    right: 20%;\n  }\n  & .peerHolder:nth-child(7) {\n    bottom: 10%;\n    left: 15%;\n  }\n  & .peerHolder:nth-child(8) {\n    bottom: 10%;\n    right: 15%;\n  }\n  & .peerHolder:nth-child(9) {\n    bottom: 44%;\n    left: 35%;\n  }\n  & .peerHolder:nth-child(10) {\n    bottom: 44%;\n    right: 35%;\n  }\n"])),oe.sm),ie=t(157),se=t(198),le=D.b.div(p||(p=Object(l.a)(["\n  max-width: 400px;\n  min-width: 200px;\n  overflow: auto;\n  text-align: left;\n  padding: 14px;\n  user-select: none;\n  background-color: ",";\n  color: ",";\n  border-radius: 8px;\n"])),(function(e){return e.theme.primary.dark}),(function(e){return e.theme.primary.contrastText})),ue=D.b.div(b||(b=Object(l.a)(["\n  font-size: calc(8px + 1vmin);\n  min-width: max-content;\n"]))),de=D.b.div(f||(f=Object(l.a)(["\n  font-size: calc(10px + 0.6vmin) !important;\n  line-height: 1.5em;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n"]))),pe=D.b.div(h||(h=Object(l.a)(["\n  margin-top: 16px;\n  margin-bottom: 16px;\n  max-height: 320px;\n  min-height: 60px;\n  overflow-y: auto;\n  overflow-x: hidden;\n"]))),be=D.b.div(j||(j=Object(l.a)(["\n  display: flex;\n  flex-direction: row-reverse;\n"]))),fe=Object(D.b)(se.a)(m||(m=Object(l.a)(["\n  margin-left: 8px !important;\n"]))),he=D.b.div(O||(O=Object(l.a)([""]))),je=D.b.a(g||(g=Object(l.a)(["\n  min-width: max-content;\n  line-height: 1.5em;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  color: ",";\n"])),(function(e){return e.theme.secondary.light})),me=t(201),Oe=Object(me.a)((function(e){return{popper:{zIndex:99,'&[x-placement*="top"]':{top:"-8px !important"},'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.9em",width:"3em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(e.palette.primary.dark," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.9em",width:"3em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(e.palette.primary.dark," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.9em",height:"3em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.primary.dark," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.9em",height:"3em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.primary.dark)}}},arrow:{position:"absolute",fontSize:7,width:"3em",height:"3em","&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}}})),ge=function(e){var n=e.enterType,t=e.anchorElement,r=e.isSelf,o=a.a.useState(null),c=Object(s.a)(o,2),i=c[0],l=c[1],u=Oe();return Object(Q.jsxs)(ie.a,{open:!!t&&!!n,anchorEl:t,placement:"top",className:u.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{element:i}},children:[Object(Q.jsx)("div",{className:u.arrow,ref:l}),Object(Q.jsx)(le,{children:Object(Q.jsxs)(ue,{children:["drag"===n&&"Drop here to send files","mouse"===n&&"Click here to ".concat(r?"send to all":"send files")]})})]})},xe=t(115),we=Object(xe.a)("#468266",.3),ve=Object(D.c)(x||(x=Object(l.a)(["\n  0% {\n    box-shadow: \n      0 0 0 0 ",", \n      0 0 0 0.5em ",";\n  }\n  100% {\n    box-shadow:\n      0 0 0 0.5em ",", \n      0 0 0 1.5em transparent;\n  }\n"])),we,we,we),ye=Object(D.c)(w||(w=Object(l.a)(["\n  0% {\n    box-shadow: \n      0 0 0 0 ",", \n      0 0 0 1em ",", \n      0 0 0 2em ",";\n  }\n  100% {\n    box-shadow:\n      0 0 0 1em ",", \n      0 0 0 2em ",",\n      0 0 0 3.5em transparent;\n  }\n"])),we,we,we,we,we),Ce=Object(D.b)(se.a)(v||(v=Object(l.a)(["\n  background-color: "," !important;\n  color: "," !important;\n  &:hover {\n    background: "," !important;\n  }\n  border-radius: 50% !important;\n  height: 64px;\n  width: 64px;\n  span.MuiButton-label {\n    font-size: 25px;\n    width: 25px;\n  }\n"])),(function(e){return e.theme.secondary.main}),(function(e){return e.theme.secondary.contrastText}),(function(e){return e.theme.secondary.dark})),ke=Object(D.b)(Ce)(y||(y=Object(l.a)(["\n  animation: "," 1s linear infinite;\n"])),ve),De=Object(D.b)(Ce)(C||(C=Object(l.a)(["\n  animation: "," 0.7s linear infinite;\n"])),ye),Ie=t(116),Re=function(e,n){return e.length>n?e.substring(0,n)+"...":e};var Se,Te,Ae,Pe,Ee,Fe,Me,ze,Le,Be,_e,Ne,Ue,We,He,$e,Je,Ge,Ye,Xe,qe=function(e){e.length>5?F.b.error("The maximum number of transfer files is set up to ".concat(5)):e.forEach((function(e){var n=e.file,t=e.errors;F.b.error("Unable to transfer ".concat(Re(n.name,9)).concat(t.find((function(e){return"file-too-large"===e.code}))?". The maximum size per file is set up to 16mb":""))}))},Ke=function(e){var n=e.shouldDisableActionBtn,t=e.handleFileInputChange,r=a.a.useState(null),o=Object(s.a)(r,2),c=o[0],i=o[1],l=Object(Ie.a)({maxFiles:5,maxSize:X,disabled:n,onDragEnter:function(){return i("drag")},onDragLeave:function(){return i(null)},onDropAccepted:t,onDropRejected:qe}),u=l.getRootProps,d=l.getInputProps;return a.a.useEffect((function(){n&&i(null)}),[n]),{getRootProps:u,getInputProps:d,onMouseEnter:function(){return i("mouse")},onMouseLeave:function(){return i(null)},enterType:c}},Qe=D.b.div(Se||(Se=Object(l.a)(["\n  z-index: 1;\n  position: fixed;\n  bottom: 1em;\n  left: 50%;\n  transform: translateX(-50%);\n  padding-left: ",";\n"])),(function(e){return e.theme.drawerMinWidth})),Ve=D.b.div(Te||(Te=Object(l.a)(["\n  font-size: 14px;\n  color: ",";\n  text-transform: capitalize;\n"])),(function(e){return e.theme.primary.contrastText})),Ze=function(e){var n=e.selfIdentity,t=e.shouldDisableActionBtn,r=e.handleFileInputChange,o=a.a.useRef(null),c=Ke({shouldDisableActionBtn:t,handleFileInputChange:r}),s=c.getRootProps,l=c.getInputProps,u=c.onMouseEnter,d=c.onMouseLeave,p=c.enterType;return Object(Q.jsxs)(Qe,{children:[Object(Q.jsxs)("div",Object(i.a)(Object(i.a)({},s()),{},{children:[Object(Q.jsxs)(De,{className:"peerBtn",ref:o,onMouseEnter:u,onMouseLeave:d,onClick:function(){return document.getElementById("fileInput-self").value=""},variant:"contained",children:[Object(Q.jsx)("span",{children:n.emoji}),Object(Q.jsx)("input",Object(i.a)({id:"fileInput-self"},l()))]}),Object(Q.jsxs)(Ve,{children:["You: ",n.platform,"-",n.browser]})]})),Object(Q.jsx)(ge,{isSelf:!0,enterType:p,anchorElement:o.current})]})},en=t(42),nn=t(59),tn=D.b.div(Ae||(Ae=Object(l.a)(["\n  position: relative;\n  font-size: 14px;\n  color: ",";\n  text-transform: capitalize;\n  min-width: max-content;\n  left: 50%;\n  transform: translateX(-50%);\n"])),(function(e){return e.theme.primary.contrastText})),rn=function(e){var n=e.shouldDisableActionBtn,t=e.handleFileInputChange,r=e.targetPeer,o=e.setAnchorElement,c=a.a.useRef(null),s=Ke({shouldDisableActionBtn:n,handleFileInputChange:t}),l=s.getRootProps,u=s.getInputProps,d=s.onMouseEnter,p=s.onMouseLeave,b=s.enterType;a.a.useEffect((function(){c.current&&o(c.current)}),[c,o]);return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)("div",Object(i.a)(Object(i.a)({},l()),{},{children:Object(Q.jsxs)(ke,{className:"peerBtn",ref:c,disabled:n,onMouseOver:d,onMouseLeave:p,onClick:function(){return document.getElementById("fileInput-".concat(r.id)).value=""},variant:"contained",children:[Object(Q.jsx)("input",Object(i.a)({id:"fileInput-".concat(r.id)},u())),Object(Q.jsx)("span",{children:r.emoji})]})})),Object(Q.jsxs)(tn,{children:[r.platform,"-",r.browser]}),b&&Object(Q.jsx)(ge,{isSelf:!1,enterType:b,anchorElement:c.current})]})},an=D.b.div(Pe||(Pe=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  margin-top: 1em;\n"]))),on=D.b.div(Ee||(Ee=Object(l.a)(["\n  width: 100%;\n  margin-right: 1em;\n  flex-grow: 1;\n  --progress-color: ",";\n  progress {\n    width: 100%;\n    color: var(--progress-color);\n  }\n  progress[value] {\n    /* Reset the default progress */\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    appearance: none;\n    border: none;\n    height: 12px;\n  }\n  progress[value]::-moz-progress-bar {\n    background-color: var(--progress-color);\n  }\n  progress::-webkit-progress-value {\n    border-radius: 4px;\n    background-color: var(--progress-color);\n  }\n  progress::-webkit-progress-bar {\n    border-radius: 4px;\n    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.25) inset;\n  }\n"])),(function(e){return e.theme.secondary.light})),cn=D.b.div(Fe||(Fe=Object(l.a)(["\n  width: 44px;\n  color: ",";\n"])),(function(e){return e.theme.secondary.light})),sn=function(e){return Object(Q.jsxs)(an,{children:[Object(Q.jsx)(on,{children:Object(Q.jsx)("progress",{max:"100",value:e.progress})}),Object(Q.jsx)(cn,{children:"".concat(e.progress,"%")})]})},ln=a.a.createContext({shouldAutoAccept:!1,shouldAutoDownload:!1,appTheme:"dark",toggleAutoAccept:function(){},toggleAutoDownload:function(){},toggleLightDarkTheme:function(){}}),un=function(e){var n=e.children,t=function(){var e=Object(r.useState)(!1),n=Object(s.a)(e,2),t=n[0],a=n[1],o=Object(r.useState)(!1),c=Object(s.a)(o,2),i=c[0],l=c[1];return Object(r.useEffect)((function(){var e=window.localStorage.getItem(G),n=window.localStorage.getItem(Y),t=!("false"===n||!n);a(!("false"===e||!e)),l(t)}),[]),{shouldAutoAccept:t,shouldAutoDownload:i,toggleAutoAccept:function(){window.localStorage.setItem(G,(!t).toString()),a(!t)},toggleAutoDownload:function(){window.localStorage.setItem(Y,(!i).toString()),l(!i)}}}(),a=t.shouldAutoAccept,o=t.shouldAutoDownload,c=t.toggleAutoAccept,i=t.toggleAutoDownload,l=function(){var e=Object(r.useState)("dark"),n=Object(s.a)(e,2),t=n[0],a=n[1];return Object(r.useEffect)((function(){var e=window.localStorage.getItem(J);e?a(e):window.localStorage.setItem(J,"dark")}),[]),{appTheme:t,toggleLightDarkTheme:function(){var e="dark"===t?"light":"dark";window.localStorage.setItem(J,e),a(e)}}}(),u=l.appTheme,d=l.toggleLightDarkTheme;return Object(Q.jsx)(ln.Provider,{value:{shouldAutoAccept:a,shouldAutoDownload:o,appTheme:u,toggleAutoAccept:c,toggleAutoDownload:i,toggleLightDarkTheme:d},children:n})},dn={isOpen:!1,progressType:null,fileProgress:0,downloadableFiles:[]},pn=function(e,n){switch(n.type){case"clear":return Object(i.a)({},dn);case"set_received_progress":return Object(i.a)(Object(i.a)({},e),{},{isOpen:!0,progressType:"receive",fileProgress:n.payload.progress});case"set_sent_progress":return Object(i.a)(Object(i.a)({},e),{},{isOpen:!0,progressType:"send",fileProgress:n.payload.progress});case"set_downloadableFiles":return Object(i.a)(Object(i.a)({},e),{},{downloadableFiles:[].concat(Object(nn.a)(e.downloadableFiles),[n.payload.downloadableFile])});default:return e}},bn=function(e){var n=e.targetPeer,t=e.setClose,r=e.fileProgress,o=e.downloadableFiles,c=e.progressType,i=e.anchorElement,l=e.onCancelFileTransfer,u=e.shouldAutoDownload,d=a.a.useState(null),p=Object(s.a)(d,2),b=p[0],f=p[1],h=a.a.useState(null),j=Object(s.a)(h,2),m=j[0],O=j[1],g=Oe();a.a.useEffect((function(){O(o)}),[o]),a.a.useEffect((function(){u&&100===r&&t()}),[u,r]);var x=function(){l(),w()},w=function(){return t()};return Object(Q.jsxs)(ie.a,{open:!!i,anchorEl:i,placement:"top",className:g.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{element:b}},children:[Object(Q.jsx)("div",{className:g.arrow,ref:f}),Object(Q.jsx)(le,{children:"receive"===c?Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(ue,{children:u?"Download Progress: ":"Downloadable file will show below"}),Object(Q.jsxs)(pe,{children:[m&&m.map((function(e,r){return Object(Q.jsx)(he,{children:Object(Q.jsxs)(je,{onClick:function(){return function(e){setTimeout((function(){return window.URL.revokeObjectURL(e.fileBlobUrl)}),0);var n=m.filter((function(n){return n.fileBlobUrl!==e.fileBlobUrl}));n.length>0?O(n):t()}(e)},download:e.fileName,href:e.fileBlobUrl,children:["Download ",e.fileName]})},"".concat(n.id,"-download-").concat(r))})),0!==r&&Object(Q.jsx)(sn,{progress:r})]}),Object(Q.jsx)(be,{children:100===r?Object(Q.jsx)(fe,{variant:"outlined",size:"small",onClick:w,color:"secondary",children:"close"}):Object(Q.jsx)(fe,{variant:"outlined",size:"small",onClick:x,color:"secondary",children:"cancel"})})]}):Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(ue,{children:"Sending..."}),Object(Q.jsxs)(pe,{children:[Object(Q.jsx)("div",{children:"Waiting for file transfer to complete..."}),Object(Q.jsx)(sn,{progress:r})]}),Object(Q.jsx)(be,{children:Object(Q.jsx)(fe,{variant:"outlined",onClick:x,color:"secondary",children:"cancel"})})]})})]})},fn=function(e){return Object(Q.jsx)(ln.Consumer,{children:function(n){var t=n.shouldAutoDownload;return Object(Q.jsx)(bn,Object(i.a)(Object(i.a)({},e),{},{shouldAutoDownload:t}))}})},hn=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(n)+" "+["B","Kib","Mib","Gib","Tib"][t]},jn={isOpen:!1,fileMetas:null},mn=function(e,n){switch(n.type){case"clear":return Object(i.a)({},jn);case"set_file_metas":return{isOpen:!0,fileMetas:n.payload.fileMetas};default:return e}},On=function(e){var n=e.setClose,t=e.anchorElement,r=e.fileMetas,o=e.targetPeer,c=e.onCancelFileTransfer,i=e.onAcceptFileTransfer,l=a.a.useState(null),u=Object(s.a)(l,2),d=u[0],p=u[1],b=Oe();return Object(Q.jsxs)(ie.a,{open:!!t,anchorEl:t,placement:"top",className:b.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{element:d}},children:[Object(Q.jsx)("div",{className:b.arrow,ref:p}),Object(Q.jsxs)(le,{children:[Object(Q.jsxs)(ue,{children:[o.emoji," from ",o.platform," ",o.browser," wants to send:"]}),Object(Q.jsx)(pe,{children:null===r||void 0===r?void 0:r.map((function(e,n){return Object(Q.jsxs)(de,{children:[e.name," (",hn(e.size),")"]},"".concat(o.id,"-meta-").concat(n))}))}),Object(Q.jsxs)(be,{children:[Object(Q.jsx)(fe,{variant:"contained",size:"small",onClick:function(){i(),n()},color:"secondary",children:"Accept"}),Object(Q.jsx)(fe,{variant:"outlined",size:"small",onClick:function(){c(),n()},color:"secondary",children:"Decline"})]})]})]})},gn={isOpen:!1,gotRemoteDesc:!1},xn=function(e,n){switch(n.type){case"clear":return Object(i.a)({},gn);case"set_open_with_desc":return{isOpen:!0,gotRemoteDesc:!0};case"set_open_without_desc":return{isOpen:!0,gotRemoteDesc:!1};case"set_desc":return Object(i.a)(Object(i.a)({},e),{},{gotRemoteDesc:!0});default:return e}},wn=function(e){var n=e.targetPeer,t=e.gotRemoteDesc,r=e.anchorElement,o=a.a.useState(null),c=Object(s.a)(o,2),i=c[0],l=c[1],u=Oe();return a.a.useEffect((function(){var e;return sessionStorage.setItem(H,"1"),t&&(e=setTimeout((function(){sessionStorage.setItem(W,"1"),window.location.reload()}),6e3)),function(){clearTimeout(e),sessionStorage.removeItem(H)}}),[t]),Object(Q.jsxs)(ie.a,{open:!!r,anchorEl:r,placement:"top",className:u.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{element:i}},children:[Object(Q.jsx)("div",{className:u.arrow,ref:l}),Object(Q.jsx)(le,{children:Object(Q.jsx)(ue,{children:t?"Preparing data channel with ".concat(n.emoji,"..."):"Waiting for ".concat(n.emoji,"'s response...")})})]})},vn=function(e){var n=e.publicID,t=e.firestoreDbRef,a=e.connectionIdRef,o=e.peerConnectionRef,c=e.callerUnsubscriberRef,i=e.dispatchProgressPopperData,s=e.dispatchWaitResponsePopperData,l=e.handleDownloadFile,u=e.clearSignalService,d=Object(r.useRef)(null),p=Object(r.useCallback)((function(){s({type:"clear"}),d.current&&(d.current.close(),console.log("Closed receive data channel with label: ".concat(d.current.label))),u()}),[d,s,u]),b=Object(r.useCallback)((function(){o.current.ondatachannel=function(e){console.log("Receive Channel Callback"),d.current=e.channel,d.current.binaryType="arraybuffer",d.current.onmessage=h,d.current.onopen=m,d.current.onclose=m};var e=t.collection(L).doc(n).collection(B).doc(a.current),r=0,c=0,u=0,b=0,f=[];function h(e){return j.apply(this,arguments)}function j(){return(j=Object(te.a)(ne.a.mark((function n(t){var a,o,s,d,h,j,m,O;return ne.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.get();case 2:if((a=n.sent).data()){n.next=5;break}return n.abrupt("return");case 5:f.push(t.data),c+=t.data.byteLength,b+=t.data.byteLength,o=a.data().fileMetas,s=o.reduce((function(e,n){return e+n.size}),0),d=o[u],h=d.name,j=d.size,m=Math.round(c/s*100),i({type:"set_received_progress",payload:{progress:m}}),b===j&&(O=new Blob(f),f=[],b=0,u+=1,l(O,h)),c===s&&(r=1,p());case 15:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function m(){return O.apply(this,arguments)}function O(){return(O=Object(te.a)(ne.a.mark((function e(){var n;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.current&&(n=d.current.readyState,console.log("Receive channel state is: ".concat(n)),"open"===n&&s({type:"clear"}),"closed"===n&&(r||F.b.warn("File transfer is cancelled"),r=0,d.current=null));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}),[a,t,o,d,n,i,s,l,p]);return{receiveChannelRef:d,joinTransferChannel:function(){var e=Object(te.a)(ne.a.mark((function e(r){var i,s,l,u,d,p,f,h;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.collection(L).doc(n),s=i.collection(B).doc(r),e.next=4,s.get();case 4:if(!(l=e.sent).exists){e.next=25;break}return a.current=r,o.current=new RTCPeerConnection(z),b(),u=s.collection(_),o.current.addEventListener("icecandidate",(function(e){e.candidate?u.add(e.candidate.toJSON()):console.log("Got final candidate!")})),d=s.collection(N).onSnapshot((function(e){e.docChanges().forEach(function(){var e=Object(te.a)(ne.a.mark((function e(n){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==n.type){e.next=6;break}return t=n.doc.data(),console.log("Got new remote ICE candidate: ".concat(JSON.stringify(t))),console.log(o.current),e.next=6,o.current.addIceCandidate(new RTCIceCandidate(t));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())})),c.current=d,p=l.data().offer,console.log("Got offer:",p),e.next=17,o.current.setRemoteDescription(new RTCSessionDescription(p));case 17:return e.next=19,o.current.createAnswer();case 19:return f=e.sent,console.log("Created answer:",f),e.next=23,o.current.setLocalDescription(f);case 23:h={answer:{type:f.type,sdp:f.sdp},isAccepting:!0},s.update(h);case 25:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}},yn=function(e){var n=e.localID,t=e.publicID,a=e.firestoreDbRef,o=e.connectionIdRef,c=e.peerConnectionRef,s=e.calleeUnsubscriberRef,l=e.descriptionUnsubscriberRef,u=e.totalFileSizeRef,d=e.sentFileReaderRef,p=e.acceptedFileListRef,b=e.dispatchWaitResponsePopperData,f=e.dispatchProgressPopperData,h=Object(r.useRef)(null),j=Object(r.useCallback)(Object(te.a)(ne.a.mark((function e(){var n,t,r,a,o,i,s,l,b,j;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b=function(){F.b.success("File has been transferred"),i=0,s=0,l=0,f({type:"clear"}),p.current=[]},p.current&&0!==p.current.length){e.next=3;break}return e.abrupt("return");case 3:console.log("Sending files:",p.current),r=Object(nn.a)(p.current),a=null===(n=c.current)||void 0===n||null===(t=n.sctp)||void 0===t?void 0:t.maxMessageSize,console.log("maximum message size is: ",a),o=a||16384,i=0,s=0,l=0,d.current=new FileReader,d.current.addEventListener("error",(function(e){console.error("Error reading file:",e),F.b.error("Failed to read file: ".concat(r[s].name))})),d.current.addEventListener("abort",(function(e){console.log("File reading aborted:",e),F.b.warn("Abort file read: ".concat(r[s].name))})),d.current.addEventListener("load",(function(e){var n=e.target.result;h.current.send(n),l+=n.byteLength,i+=n.byteLength;var t=Math.round(l/u.current*100);f({type:"set_sent_progress",payload:{progress:t}}),l<u.current?function e(){h.current.bufferedAmount+n.byteLength<16777216?j(i):setTimeout(e,500)}():(console.log("transfer done"),b())})),(j=function(e){var n;if(e<r[s].size){var t=e+o;t>r[s].size&&(t=r[s].size),n=r[s].slice(i,t)}else{if(i=0,!r[s+=1])return void b();n=r[s].slice(i,o)}d.current.readAsArrayBuffer(n)})(0);case 17:case"end":return e.stop()}}),e)}))),[h,u,d,p,c,f]),m=Object(r.useCallback)((function(){function e(){if(h.current){var e=h.current.readyState;console.log("Send channel state is: ".concat(e)),"open"===e&&(j(),b({type:"clear"})),"closed"===e&&(h.current=null)}}h.current=c.current.createDataChannel("sendDataChannel"),console.log("Created send data channel: ",h.current),h.current.binaryType="arraybuffer",h.current.onopen=e,h.current.onclose=e,h.current.onerror=function(e){if(h.current)return void console.error("Error in sendChannel:",e);console.log("Error in sendChannel which is already closed:",e)}}),[c,h,j,b]);return{sendChannelRef:h,tryCreatePeerConnection:function(){var e=Object(te.a)(ne.a.mark((function e(r){var u,d,p,f,h,j,O,g,x;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=a.collection(L).doc(t),d=u.collection(B),p=d.doc(),f={p2p:{offer:n,answer:r.id}},h=p.collection(N),c.current=new RTCPeerConnection(z),o.current=p.id,m(),c.current.addEventListener("icecandidate",(function(e){e.candidate?h.add(e.candidate.toJSON()):console.log("Got final candidate!")})),j=p.onSnapshot(function(){var e=Object(te.a)(ne.a.mark((function e(n){var t,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=n.data())&&t.answer){e.next=3;break}return e.abrupt("return");case 3:if(!c.current||c.current.currentRemoteDescription){e.next=8;break}return r=new RTCSessionDescription(t.answer),e.next=7,c.current.setRemoteDescription(r);case 7:b({type:"set_desc"});case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),l.current=j,O=p.collection(_).onSnapshot((function(e){e.docChanges().forEach(function(){var e=Object(te.a)(ne.a.mark((function e(n){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==n.type){e.next=4;break}return t=n.doc.data(),e.next=4,c.current.addIceCandidate(new RTCIceCandidate(t));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())})),s.current=O,e.next=15,c.current.createOffer();case 15:return g=e.sent,e.next=18,c.current.setLocalDescription(g);case 18:return console.log("Created offer:",g),x={offer:{type:g.type,sdp:g.sdp},isAccepting:!1},e.next=22,p.set(Object(i.a)(Object(i.a)({},x),f));case 22:b({type:"set_open_without_desc"});case 23:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}},Cn=function(e){var n=e.targetPeer,t=e.localID,a=e.publicID,o=e.firestoreDbRef,c=e.sendAllFiles,l=e.clearSentAllFiles,u=Object(r.useRef)(!0),d=Object(r.useRef)(null),p=Object(r.useRef)(null),b=Object(r.useRef)(null),f=Object(r.useRef)(0),h=Object(r.useRef)([]),j=Object(r.useRef)(),m=Object(r.useRef)(),O=Object(r.useRef)(),g=Object(r.useState)(null),x=Object(s.a)(g,2),w=x[0],v=x[1],y=Object(r.useReducer)(xn,gn),C=Object(s.a)(y,2),k=C[0],D=C[1],I=Object(r.useReducer)(mn,jn),R=Object(s.a)(I,2),S=R[0],T=R[1],A=Object(r.useReducer)(pn,dn),P=Object(s.a)(A,2),E=P[0],M=P[1],z=Object(r.useMemo)((function(){return k.isOpen||S.isOpen||E.isOpen}),[k.isOpen,S.isOpen,E.isOpen]);Object(r.useEffect)((function(){var e=o.collection(L).doc(a).collection(B).onSnapshot(function(){var e=Object(te.a)(ne.a.mark((function e(r){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.docChanges().forEach(function(){var e=Object(te.a)(ne.a.mark((function e(r){var a,o;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.doc.data(),"modified"===r.type&&!a.isAccepting&&!a.answer&&a.fileMetas&&a.p2p&&a.p2p.answer===t&&a.p2p.offer===n.id&&ie(a.fileMetas,r.doc.id),"removed"===r.type&&(o=r.doc.id,console.log("remove connection: "),console.log(o,p.current),o!==p.current||!a.p2p||a.p2p.answer!==t&&a.p2p.offer!==t||Z(!0));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());return function(){e(),Z(!1),ee(),sessionStorage.getItem(H)&&(F.b.warn("Peer connection dropped"),sessionStorage.removeItem(H))}}),[]),Object(r.useEffect)((function(){u.current?u.current=!1:(re(Object(nn.a)(c)),l())}),[u,c]);var W=Object(r.useCallback)(Object(te.a)(ne.a.mark((function e(){var n,t,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j.current&&j.current(),m.current&&m.current(),O.current&&O.current(),!(n=p.current)){e.next=18;break}return t=o.collection(L).doc(a),r=t.collection(B).doc(n),e.next=9,r.collection(_).get();case 9:return e.sent.forEach(function(){var e=Object(te.a)(ne.a.mark((function e(n){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref.delete();case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.next=13,r.collection(N).get();case 13:return e.sent.forEach(function(){var e=Object(te.a)(ne.a.mark((function e(n){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref.delete();case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.next=17,r.delete();case 17:p.current=null;case 18:case"end":return e.stop()}}),e)}))),[o,p,j,m,O,a]),$=vn({publicID:a,firestoreDbRef:o,connectionIdRef:p,peerConnectionRef:d,callerUnsubscriberRef:j,dispatchProgressPopperData:M,dispatchWaitResponsePopperData:D,handleDownloadFile:function(e,n){if("true"===window.localStorage.getItem(Y)){var t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=n,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(t.href),document.body.removeChild(t)}else M({type:"set_downloadableFiles",payload:{downloadableFile:{fileName:n,fileBlobUrl:URL.createObjectURL(e)}}})},clearSignalService:W}),J=$.receiveChannelRef,X=$.joinTransferChannel,q=yn({localID:t,publicID:a,firestoreDbRef:o,connectionIdRef:p,peerConnectionRef:d,calleeUnsubscriberRef:m,descriptionUnsubscriberRef:O,totalFileSizeRef:f,sentFileReaderRef:b,acceptedFileListRef:h,dispatchProgressPopperData:M,dispatchWaitResponsePopperData:D}),K=q.sendChannelRef,V=q.tryCreatePeerConnection,Z=Object(r.useCallback)((function(e){D({type:"clear"}),K.current&&(K.current.close(),e&&F.b.warn("File transfer is closed"),console.log("Closed send data channel with label: ".concat(K.current.label))),J.current&&(J.current.close(),console.log("Closed receive data channel with label: ".concat(J.current.label))),W()}),[K,J,W]),ee=Object(r.useCallback)((function(){d.current&&(console.log("closing peers connection"),d.current.close(),d.current=null)}),[d]);function re(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(te.a)(ne.a.mark((function e(t){var r,c,i,s,l,u;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=13;break}return h.current=t,e.next=4,V(n);case 4:return r=p.current,c=o.collection(L).doc(a),i=c.collection(B),s=i.doc(r),l=[],t.forEach((function(e){l.push({name:e.name,size:e.size,type:e.type}),f.current+=e.size})),u=Object(en.a)({},U,l),e.next=13,s.update(u);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oe=function(){X(p.current),k.isOpen||D({type:"set_open_with_desc"})},ce=function(){b.current&&1===b.current.readyState&&(console.log("Abort file read..."),b.current.abort()),S.isOpen&&T({type:"clear"}),Z(!1)},ie=function(){var e=Object(te.a)(ne.a.mark((function e(t,r){var a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("incoming file metas:",t),console.log("got from:",n),p.current=r,a=window.localStorage.getItem(G),"true"===a?oe():T({type:"set_file_metas",payload:{fileMetas:t}});case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();return Object(Q.jsxs)("div",{className:"peerHolder",children:[Object(Q.jsx)(rn,{shouldDisableActionBtn:z,handleFileInputChange:re,targetPeer:n,setAnchorElement:v}),k.isOpen&&Object(Q.jsx)(wn,Object(i.a)(Object(i.a)({},k),{},{targetPeer:n,anchorElement:w})),E.isOpen&&Object(Q.jsx)(fn,Object(i.a)(Object(i.a)({},E),{},{onCancelFileTransfer:ce,targetPeer:n,setClose:function(){return M({type:"clear"})},anchorElement:w})),S.isOpen&&Object(Q.jsx)(On,Object(i.a)(Object(i.a)({},S),{},{onAcceptFileTransfer:oe,onCancelFileTransfer:ce,targetPeer:n,setClose:function(){return T({type:"clear"})},anchorElement:w}))]})},kn=t(159),Dn=D.b.p(Me||(Me=Object(l.a)(["\n  color: ",";\n  margin-top: ",";\n  height: ",";\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  max-width: 80%;\n  span {\n    font-size: 12px;\n  }\n"])),(function(e){return e.theme.primary.contrastText}),(function(e){return e.$shouldHide?"0px":"25%"}),(function(e){return e.$shouldHide?"0px":"auto"})),In=Object(D.b)(ce)(ze||(ze=Object(l.a)(["\n  position: relative;\n  height: 100%;\n  width: 100%;\n  z-index: 1;\n  overflow-y: auto;\n  padding-top: 1em;\n  padding-bottom: 100px;\n  @media only screen and (",") {\n    padding-bottom: 0;\n    margin-bottom: 120px;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-around;\n  }\n"])),oe.sm),Rn=function(e){var n=e.selfIdentity,t=e.publicID,o=e.localID,c=Object(r.useState)([]),i=Object(s.a)(c,2),l=i[0],u=i[1],d=Object(r.useState)([]),p=Object(s.a)(d,2),b=p[0],f=p[1],h=a.a.useRef(k.firestore());function j(){b.length>0&&f([])}Object(r.useEffect)((function(){var e=k.database().ref("".concat(t));return e.on("value",function(){var e=Object(te.a)(ne.a.mark((function e(n){var t,r,a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=n.val(),r=[],t)a!==o&&r.push(t[a]);r.length>10?(F.b.dismiss(),F.b.warn("The maximum concurrent peers is set to ".concat(10))):u(r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),function(){e.off()}}),[t]);var m=0===l.length;return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(kn.a,{in:m,children:Object(Q.jsxs)(Dn,{$shouldHide:!m,children:["Open the same link to start transfer files",Object(Q.jsx)("br",{}),Object(Q.jsx)("span",{children:"swipe right or click drawer icons to see or toggle app settings"})]})}),Object(Q.jsx)(kn.a,{in:!m,children:Object(Q.jsx)(In,{children:l.map((function(e){return Object(Q.jsx)(Cn,{clearSentAllFiles:j,sendAllFiles:b,firestoreDbRef:h.current,targetPeer:e,publicID:t,localID:o},e.id)}))})}),n&&Object(Q.jsx)(Ze,{shouldDisableActionBtn:b.length>0,handleFileInputChange:function(e){0===l.length?(F.b.warn("There is no other peers in this room"),j()):f(e)},publicID:t,localID:o,selfIdentity:n})]})},Sn=Object(r.memo)(Rn),Tn=t(6),An=t(222),Pn=t(208),En=t(207),Fn=t(111),Mn=t.n(Fn),zn=t(205),Ln=t(112),Bn=t.n(Ln),_n=t(219),Nn={light:{primary:{main:"#f1f0ea",light:"#f3f3ee",dark:"#d7d7d3",contrastText:"#025855"},secondary:{main:"#cd5521",dark:"#8f3b17",light:"#d7774d",contrastText:"#fff"}},dark:{primary:{main:"#303846",light:"#595f6b",dark:"#212731",contrastText:"#fff"},secondary:{main:"#1565C0",dark:"#0e4686",light:"#4383cc",contrastText:"#fff"}}},Un=Object(i.a)({drawerMinWidth:"55px"},Nn.dark),Wn=Object(me.a)((function(e){return Object(_n.a)({hide:{display:"none"},drawer:{flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:290,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:{width:Un.drawerMinWidth,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflow:"hidden"},titleText:{fontSize:22,position:"absolute",left:16},titleBar:{display:"flex",alignItems:"center",height:60,justifyContent:"flex-end"}})})),Hn=t(204),$n=t(203),Jn=t(202),Gn=t(206),Yn=t(220),Xn=t(221),qn=t(107),Kn=t.n(qn),Qn=t(110),Vn=t.n(Qn),Zn=t(109),et=t.n(Zn),nt=t(103),tt=t.n(nt),rt=t(104),at=t.n(rt),ot=t(101),ct=t.n(ot),it=t(102),st=t.n(it),lt=t(105),ut=t.n(lt),dt=t(106),pt=t.n(dt),bt=t(108),ft=t.n(bt),ht=Object(D.b)(Jn.a)(Le||(Le=Object(l.a)(["\n  margin-right: -16px;\n  color: "," !important;\n"])),(function(e){return e.theme.primary.contrastText})),jt=Object(D.b)($n.a)(Be||(Be=Object(l.a)(["\n  margin-top: 4px;\n  justify-content: space-between !important;\n  line-height: 1.5em;\n  cursor: pointer;\n  padding: 0.5em 1em;\n  font-size: 14px;\n  text-align: left;\n  padding-bottom: 1em;\n  visibility: ",";\n  * {\n    pointer-events: none;\n  }\n  span {\n    font-weight: 300;\n  }\n  input {\n    min-width: 200px;\n    pointer-events: auto;\n    color: ",";\n  }\n"])),(function(e){return e.$isOpen?"visible":"hidden"}),(function(e){return e.theme.primary.contrastText})),mt=Object(D.b)(Hn.a)(_e||(_e=Object(l.a)(["\n  margin-top: auto !important;\n"]))),Ot=function(e){var n=e.publicID,t=e.drawerOpen,r=e.shouldAutoAccept,a=e.shouldAutoDownload,o=e.appTheme,c=e.toggleAutoAccept,i=e.toggleAutoDownload,s=e.toggleLightDarkTheme,l=e.handleJoinRoomModalOpen,u=e.handleAboutModalOpen,d=function(){var e=Object(te.a)(ne.a.mark((function e(t){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),e.prev=1,e.next=4,navigator.clipboard.writeText(n);case 4:F.b.dismiss(),F.b.info("Room Id copied",{autoClose:3e3}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),document.getElementById(q).select();case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}();return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsxs)(Hn.a,{children:[Object(Q.jsx)(zn.a,{title:"Auto Accept",placement:"right",children:Object(Q.jsxs)($n.a,{button:!0,onClick:c,children:[Object(Q.jsx)(ht,{children:r?Object(Q.jsx)(ct.a,{}):Object(Q.jsx)(st.a,{})}),Object(Q.jsx)(Gn.a,{primary:"Auto Accept Request"}),Object(Q.jsx)(Yn.a,{checked:r,inputProps:{"aria-label":"secondary checkbox"}})]})}),Object(Q.jsx)(zn.a,{title:"Auto Download",placement:"right",children:Object(Q.jsxs)($n.a,{button:!0,onClick:i,children:[Object(Q.jsx)(ht,{children:a?Object(Q.jsx)(tt.a,{}):Object(Q.jsx)(at.a,{})}),Object(Q.jsx)(Gn.a,{primary:"Auto Download File"}),Object(Q.jsx)(Yn.a,{checked:a,inputProps:{"aria-label":"secondary checkbox"}})]})})]}),Object(Q.jsx)(Pn.a,{}),Object(Q.jsxs)(Hn.a,{children:[Object(Q.jsx)(zn.a,{title:"Brightness Theme",placement:"right",children:Object(Q.jsxs)($n.a,{button:!0,onClick:s,children:[Object(Q.jsx)(ht,{children:"light"===o?Object(Q.jsx)(ut.a,{}):Object(Q.jsx)(pt.a,{})}),Object(Q.jsx)(Gn.a,{primary:"Light / Dark Theme"})]})}),Object(Q.jsx)(zn.a,{title:"Join Another Room",placement:"right",children:Object(Q.jsxs)($n.a,{button:!0,onClick:l,children:[Object(Q.jsx)(ht,{children:Object(Q.jsx)(Kn.a,{})}),Object(Q.jsx)(Gn.a,{primary:"Join a room"})]})})]}),Object(Q.jsx)(Pn.a,{}),Object(Q.jsx)(Hn.a,{children:Object(Q.jsxs)(jt,{button:!0,id:K,$isOpen:t,onClick:function(e){return d(e)},children:[Object(Q.jsxs)("div",{children:[Object(Q.jsx)("span",{children:"Room ID:"}),Object(Q.jsx)("br",{}),Object(Q.jsx)(Xn.a,{id:q,value:n,inputProps:{"aria-label":"naked"}})]}),Object(Q.jsx)(ht,{children:Object(Q.jsx)(ft.a,{})})]})}),Object(Q.jsxs)(mt,{children:[Object(Q.jsx)(zn.a,{title:"About",placement:"right",children:Object(Q.jsxs)($n.a,{button:!0,onClick:u,children:[Object(Q.jsx)(ht,{children:Object(Q.jsx)(et.a,{})}),Object(Q.jsx)(Gn.a,{primary:"About"})]})}),Object(Q.jsx)(zn.a,{title:"Source Code",placement:"right",children:Object(Q.jsxs)($n.a,{button:!0,onClick:function(){return window.open("https://github.com/haooowu/PeerTransfer")},children:[Object(Q.jsx)(ht,{children:Object(Q.jsx)(Vn.a,{})}),Object(Q.jsx)(Gn.a,{primary:"Source"})]})})]})]})},gt=function(e){return Object(Q.jsx)(V.Consumer,{children:function(n){var t=n.publicID;return Object(Q.jsx)(Ot,Object(i.a)({publicID:t},e))}})},xt=t(217),wt=t(210),vt=t(209),yt=t(212),Ct=t(213),kt=t(211),Dt=Object(D.b)(vt.a)(Ne||(Ne=Object(l.a)(["\n  padding: 8px 16px !important;\n"]))),It=new RegExp(/^[a-zA-Z0-9+/=]+$/),Rt=function(e){var n=e.open,t=e.handleClose,r=a.a.useState(""),o=Object(s.a)(r,2),c=o[0],i=o[1];return Object(Q.jsxs)(wt.a,{open:n,onClose:t,children:[Object(Q.jsx)(kt.a,{children:"Join or Create Room"}),Object(Q.jsxs)(yt.a,{children:[Object(Q.jsx)(Ct.a,{children:"You can find current room ID by expand the side drawer"}),Object(Q.jsx)(xt.a,{onChange:function(e){var n=e.target.value;(It.test(n)||""===n)&&i(n)},value:c,autoFocus:!0,color:"secondary",margin:"dense",label:"Room ID",type:"text",fullWidth:!0})]}),Object(Q.jsxs)(Dt,{children:[Object(Q.jsx)(se.a,{onClick:t,color:"secondary",children:"Cancel"}),Object(Q.jsx)(se.a,{onClick:function(){!c.trim()||c.length<1||c.length>30?F.b.error("Invalid room id format"):(sessionStorage.setItem($,c),window.location.reload())},color:"secondary",children:"Confirm"})]})]})},St=t(214),Tt=D.b.div(Ue||(Ue=Object(l.a)(["\n  font-weight: bold;\n  font-size: 12px;\n  text-transform: uppercase;\n  margin-bottom: 1em;\n"]))),At=function(e){var n=e.open,t=e.handleClose;return Object(Q.jsx)(wt.a,{open:n,onClose:t,children:Object(Q.jsxs)(yt.a,{children:[Object(Q.jsx)(Tt,{children:"About"}),Object(Q.jsxs)(Ct.a,{children:["This App uses ",Object(Q.jsx)("strong",{children:"WebRTC"})," for secure end-to-end peer connection (you can"," ",Object(Q.jsx)(St.a,{href:"https://test.webrtc.org/",rel:"noreferrer",target:"_blank",children:"test here"}),"), together with free STUN server from Google, and Firebase for signalling service and peer presence management. Only the following data is used by Firebase for WebRTC signalling:",Object(Q.jsxs)("ul",{children:[Object(Q.jsx)("li",{children:"File metadata including file name, size and type"}),Object(Q.jsx)("li",{children:"ICE candidate descriptions, offers and answers that contain SDP information."}),Object(Q.jsx)("li",{children:"Your public IP address is also used and served as the default room ID (in base64 encoded format). "})]}),"You can also join another network room by entering their ID, or create custom ones from your own."]}),Object(Q.jsx)(Tt,{children:"Get Started"}),Object(Q.jsx)(Ct.a,{children:"Peers in the same network or room ID should appear in the app with their device and browser info, start transfer file by drag and drop files or click their emoji to select files for transfer."}),Object(Q.jsx)(Ct.a,{children:"You can swipe right or click the drawer menu icon to see the app settings and your current room ID."}),Object(Q.jsxs)(Ct.a,{children:["Maximum file size is set to ",Object(Q.jsx)("strong",{children:hn(X,0)}),", with up to"," ",Object(Q.jsx)("strong",{children:5})," file peer transfer and up to ",Object(Q.jsx)("strong",{children:10})," ","peers each room."]})]})})},Pt=Object(D.b)(En.a)(We||(We=Object(l.a)(["\n  width: ",";\n  height: ",";\n  color: "," !important;\n"])),(function(e){return e.theme.drawerMinWidth}),(function(e){return e.theme.drawerMinWidth}),(function(e){return e.theme.primary.contrastText})),Et=Object(D.b)(An.a)(He||(He=Object(l.a)(["\n  .MuiDrawer-paper {\n    background-color: "," !important;\n    color: "," !important;\n    overflow-x: hidden;\n  }\n"])),(function(e){return e.theme.primary.light}),(function(e){return e.theme.primary.contrastText})),Ft=function(e){var n,t,r=e.gestureDirection,o=e.contextProps,c=Wn(),l=a.a.useState(!1),u=Object(s.a)(l,2),d=u[0],p=u[1],b=a.a.useState(!1),f=Object(s.a)(b,2),h=f[0],j=f[1],m=a.a.useState(!1),O=Object(s.a)(m,2),g=O[0],x=O[1];a.a.useEffect((function(){"left"===r&&p(!1),"right"===r&&p(!0),r||p(!1)}),[r]);return Object(Q.jsxs)(Et,{variant:"permanent",className:Object(Tn.a)(c.drawer,(n={},Object(en.a)(n,c.drawerOpen,d),Object(en.a)(n,c.drawerClose,!d),n)),classes:{paper:Object(Tn.a)((t={},Object(en.a)(t,c.drawerOpen,d),Object(en.a)(t,c.drawerClose,!d),t))},children:[Object(Q.jsxs)("div",{className:c.titleBar,children:[d&&Object(Q.jsx)("div",{className:c.titleText,children:"PeerTransfer"}),Object(Q.jsx)(zn.a,{title:d?"Close Menu":"Open Menu",placement:"right",children:Object(Q.jsx)(Pt,{disableRipple:!0,onClick:function(){return p((function(e){return!e}))},children:d?Object(Q.jsx)(Mn.a,{}):Object(Q.jsx)(Bn.a,{})})})]}),Object(Q.jsx)(Pn.a,{}),Object(Q.jsx)(gt,Object(i.a)({drawerOpen:d,handleJoinRoomModalOpen:function(){return j(!0)},handleAboutModalOpen:function(){return x(!0)}},o)),Object(Q.jsx)(Rt,{open:h,handleClose:function(){return j(!1)}}),Object(Q.jsx)(At,{open:g,handleClose:function(){return x(!1)}})]})},Mt=function(e){return Object(Q.jsx)(ln.Consumer,{children:function(n){return Object(Q.jsx)(Ft,Object(i.a)(Object(i.a)({},e),{},{contextProps:n}))}})},zt=Object(D.b)(A.a)($e||($e=Object(l.a)([""]))),Lt=D.b.div(Je||(Je=Object(l.a)(["\n  position: absolute;\n  bottom: 0;\n  background-image: url(",");\n  background-repeat: no-repeat;\n  background-position: bottom;\n  background-size: cover;\n  width: 100%;\n  height: 100%;\n  max-height: 1600px;\n"])),P),Bt=D.b.div(Ge||(Ge=Object(l.a)(["\n  position: relative;\n  background-color: ",";\n  height: 100%;\n  min-height: 100%;\n  max-width: 100vw;\n  overflow-x: hidden;\n  overflow-y: hidden;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  justify-content: center;\n  font-size: calc(10px + 2vmin);\n  color: white;\n"])),(function(e){return e.theme.primary.main})),_t=Object(D.b)(Bt)(Ye||(Ye=Object(l.a)(["\n  margin-left: ",";\n  z-index: 10;\n  p,\n  button,\n  label {\n    z-index: 1;\n  }\n"])),(function(e){return e.theme.drawerMinWidth})),Nt=function(e){var n=e.publicID,t=e.localID,a=Object(r.useState)(),o=Object(s.a)(a,2),c=o[0],l=o[1],u=Object(r.useState)(),d=Object(s.a)(u,2),p=d[0],b=d[1];Object(r.useEffect)((function(){!function(){var e=k.database(),r=Object(i.a)({id:t,emoji:"".concat(R())},T()),a=e.ref("".concat(n,"/").concat(t));a.set(r),a.onDisconnect().remove(),l(r)}()}),[t,n]),Object(r.useLayoutEffect)((function(){sessionStorage.getItem(W)&&(Object(F.b)(Object(Q.jsx)("div",{children:"Failed to establish data transfer channel, please try again"}),{autoClose:!1,type:"warning"}),sessionStorage.removeItem(W))}),[]);var f=Object(E.a)({onDragEnd:function(e){if(e.event.target!==document.getElementById(q)&&e.event.target!==document.getElementById(K)){var n=Math.sign(e.movement[0]),t=Math.sign(e.movement[1]);Math.abs(e.movement[0])>8&&(-1===n&&b("left"),1===n&&b("right")),0===n&&0===t&&b(void 0)}}});return Object(Q.jsxs)(_t,Object(i.a)(Object(i.a)({},f()),{},{children:[Object(Q.jsx)(Mt,{gestureDirection:p}),Object(Q.jsx)(Sn,{selfIdentity:c,publicID:n,localID:t}),Object(Q.jsx)(Lt,{})]}))},Ut=function(){return Object(Q.jsx)(V.Consumer,{children:function(e){var n=e.localID,t=e.publicID;return n&&t?Object(Q.jsx)(Nt,{localID:n,publicID:t}):Object(Q.jsx)(Bt,{children:Object(Q.jsx)(zt,{color:"secondary"})})}})},Wt=t(117),Ht=["className"],$t=Object(D.b)((function(e){var n=e.className,t=Object(Wt.a)(e,Ht);return Object(Q.jsx)("div",{className:n,children:Object(Q.jsx)(F.a,Object(i.a)({},t))})})).attrs({})(Xe||(Xe=Object(l.a)(["\n  .Toastify__toast-container {\n    width: max-content;\n    max-width: 80vw;\n  }\n  .Toastify__toast-body {\n    font-family: 'Roboto', sans-serif;\n    white-space: pre-line;\n    min-width: 200px;\n  }\n"]))),Jt=t(216),Gt=t(114),Yt=(t(151),t(152),function(e){var n=e.appTheme,t=Object(Gt.a)({palette:{primary:{main:Nn[n].primary.main,dark:Nn[n].primary.dark},secondary:{main:Nn[n].secondary.main}}});return Object(Q.jsx)(D.a,{theme:Object(i.a)(Object(i.a)({},Un),Nn[n]),children:Object(Q.jsxs)(Jt.a,{theme:t,children:[Object(Q.jsx)(Ut,{}),Object(Q.jsx)($t,{position:"top-right",autoClose:5e3,pauseOnFocusLoss:!1,newestOnTop:!1,closeOnClick:!0,hideProgressBar:!0,rtl:!1,draggable:!0})]})})}),Xt=function(){return Object(Q.jsx)(Z,{children:Object(Q.jsx)(un,{children:Object(Q.jsx)(ln.Consumer,{children:function(e){var n=e.appTheme;return Object(Q.jsx)(Yt,{appTheme:n})}})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var qt=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,223)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,o=n.getLCP,c=n.getTTFB;t(e),r(e),a(e),o(e),c(e)}))};c.a.render(Object(Q.jsx)(a.a.StrictMode,{children:Object(Q.jsx)(Xt,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),qt()}},[[153,1,2]]]);
//# sourceMappingURL=main.783c59da.chunk.js.map