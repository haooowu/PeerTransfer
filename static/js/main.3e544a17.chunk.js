(this["webpackJsonppeer-transfer"]=this["webpackJsonppeer-transfer"]||[]).push([[0],{137:function(e,n,t){},151:function(e,n,t){},153:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(18),c=t.n(o),i=(t(137),t(9)),s=t(17),l=t(12),u=t(80);t(155),t(138),t(141);u.a.initializeApp({apiKey:"AIzaSyBeFSn6EPYfSzFt6BhqeM-33Vd96NdT33Q",authDomain:"peertransfer-44201.firebaseapp.com",databaseURL:"https://peertransfer-44201-default-rtdb.firebaseio.com",projectId:"peertransfer-44201",storageBucket:"peertransfer-44201.appspot.com",messagingSenderId:"640914820360",appId:"1:640914820360:web:51564296511922d704f0bd"});var d,p,b,f,h,j,m,O,g,x,w,v,y,C,k=u.a,D=t(11),I=function(){for(var e,n=[],t=128512;t<=128591;t+=1)n.push(String.fromCodePoint(t));var r=Math.floor(Math.random()*n.length);return e=n[r],n.splice(r,1),e},R=t(91),S=function(){var e=R.parse(window.navigator.userAgent);return{browser:e.browser.name||"unknown",platform:e.platform.type||"unknown"}},T=t(215),A=t.p+"static/media/backgroundRipple.48d86bdf.svg",P=t(113),E=t(19),F=t(218),M={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},z="transferRooms",L="connections",B="calleeCandidates",_="callerCandidates",N="fileMetas",U="dataChannelTimeout",W="waitRemoteDesc",H="publicID",$="appTheme",J="appAutoAccept",G="appAutoDownload",Y=16777216,X="public-id",q="public-id-wrapper",K=t(4),Q=a.a.createContext({localID:"",publicID:"",setPublicID:function(){}}),V=function(e){var n=e.children,t=a.a.useState(""),o=Object(s.a)(t,2),c=o[0],i=o[1],l=a.a.useState(""),u=Object(s.a)(l,2),d=u[0],p=u[1];return Object(r.useEffect)((function(){var e,n,t=new RTCPeerConnection(M);n=t.createDataChannel(""),t.createOffer().then((function(e){var n;return null===(n=t)||void 0===n?void 0:n.setLocalDescription(e)}));var r=sessionStorage.getItem(H);t.onicecandidate=function(a){var o;if(!a||!a.candidate||!a.candidate.candidate)return n&&n.close(),n=null,null===(o=t)||void 0===o||o.close(),void(t=null);var c=a.candidate.candidate.split(" ");if("host"!==c[7]){if(r)return void p(r);e||p(btoa(c[4])),e=c[4]}},k.auth().signInAnonymously().then((function(){return i(Object(F.a)())})).catch((function(){return E.b.error("Failed to connect to firebase, please check your internet connection and try again")}))}),[]),Object(K.jsx)(Q.Provider,{value:{localID:c,publicID:d,setPublicID:p},children:n})},Z=t(15),ee=t.n(Z),ne=t(21),te="768px",re="1200px",ae={xs:"max-width: ".concat("320px"),sm:"max-width: ".concat(te),lg:"max-width: ".concat(re)},oe=D.b.div(d||(d=Object(l.a)(["\n  .peerHolder {\n    border-radius: 50%;\n    width: 64px;\n    height: 64px;\n    position: absolute;\n    z-index: 1;\n    @media only screen and (",") {\n      position: relative;\n      bottom: unset !important;\n      left: unset !important;\n      right: unset !important;\n      transform: unset !important;\n      margin-left: auto;\n      margin-right: auto;\n      margin-bottom: 3em;\n    }\n  }\n  & .peerHolder:nth-child(1) {\n    bottom: 33%;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n  & .peerHolder:nth-child(2) {\n    bottom: 20%;\n    left: 30%;\n  }\n  & .peerHolder:nth-child(3) {\n    bottom: 20%;\n    right: 30%;\n  }\n  & .peerHolder:nth-child(4) {\n    bottom: 58%;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n  & .peerHolder:nth-child(5) {\n    bottom: 30%;\n    left: 20%;\n  }\n  & .peerHolder:nth-child(6) {\n    bottom: 30%;\n    right: 20%;\n  }\n  & .peerHolder:nth-child(7) {\n    bottom: 10%;\n    left: 15%;\n  }\n  & .peerHolder:nth-child(8) {\n    bottom: 10%;\n    right: 15%;\n  }\n  & .peerHolder:nth-child(9) {\n    bottom: 44%;\n    left: 35%;\n  }\n  & .peerHolder:nth-child(10) {\n    bottom: 44%;\n    right: 35%;\n  }\n"])),ae.sm),ce=t(157),ie=t(198),se=D.b.div(p||(p=Object(l.a)(["\n  max-width: 400px;\n  min-width: 200px;\n  overflow: auto;\n  text-align: left;\n  padding: 14px;\n  user-select: none;\n  background-color: ",";\n  color: ",";\n  border-radius: 8px;\n"])),(function(e){return e.theme.primary.dark}),(function(e){return e.theme.primary.contrastText})),le=D.b.div(b||(b=Object(l.a)(["\n  font-size: calc(8px + 1vmin);\n  min-width: max-content;\n"]))),ue=D.b.div(f||(f=Object(l.a)(["\n  font-size: calc(10px + 0.6vmin) !important;\n  line-height: 1.5em;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n"]))),de=D.b.div(h||(h=Object(l.a)(["\n  margin-top: 16px;\n  margin-bottom: 16px;\n  max-height: 320px;\n  min-height: 60px;\n  overflow-y: auto;\n  overflow-x: hidden;\n"]))),pe=D.b.div(j||(j=Object(l.a)(["\n  display: flex;\n  flex-direction: row-reverse;\n"]))),be=Object(D.b)(ie.a)(m||(m=Object(l.a)(["\n  margin-left: 8px !important;\n"]))),fe=D.b.div(O||(O=Object(l.a)([""]))),he=D.b.a(g||(g=Object(l.a)(["\n  min-width: max-content;\n  line-height: 1.5em;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  color: ",";\n"])),(function(e){return e.theme.secondary.light})),je=t(201),me=Object(je.a)((function(e){return{popper:{zIndex:99,'&[x-placement*="top"]':{top:"-8px !important"},'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.9em",width:"3em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(e.palette.primary.dark," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.9em",width:"3em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(e.palette.primary.dark," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.9em",height:"3em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.primary.dark," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.9em",height:"3em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.primary.dark)}}},arrow:{position:"absolute",fontSize:7,width:"3em",height:"3em","&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}}})),Oe=function(e){var n=e.enterType,t=e.anchorElement,r=e.isSelf,o=a.a.useState(null),c=Object(s.a)(o,2),i=c[0],l=c[1],u=me();return Object(K.jsxs)(ce.a,{open:!!t&&!!n,anchorEl:t,placement:"top",className:u.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{element:i}},children:[Object(K.jsx)("div",{className:u.arrow,ref:l}),Object(K.jsx)(se,{children:Object(K.jsxs)(le,{children:["drag"===n&&"Drop here to send files","mouse"===n&&"Click here to ".concat(r?"send to all":"send files")]})})]})},ge=t(115),xe=Object(ge.a)("#468266",.3),we=Object(D.c)(x||(x=Object(l.a)(["\n  0% {\n    box-shadow: \n      0 0 0 0 ",", \n      0 0 0 0.5em ",";\n  }\n  100% {\n    box-shadow:\n      0 0 0 0.5em ",", \n      0 0 0 1.5em transparent;\n  }\n"])),xe,xe,xe),ve=Object(D.c)(w||(w=Object(l.a)(["\n  0% {\n    box-shadow: \n      0 0 0 0 ",", \n      0 0 0 1em ",", \n      0 0 0 2em ",";\n  }\n  100% {\n    box-shadow:\n      0 0 0 1em ",", \n      0 0 0 2em ",",\n      0 0 0 3.5em transparent;\n  }\n"])),xe,xe,xe,xe,xe),ye=Object(D.b)(ie.a)(v||(v=Object(l.a)(["\n  background-color: "," !important;\n  color: "," !important;\n  &:hover {\n    background: "," !important;\n  }\n  border-radius: 50% !important;\n  height: 64px;\n  width: 64px;\n  span.MuiButton-label {\n    font-size: 25px;\n    width: 25px;\n  }\n"])),(function(e){return e.theme.secondary.main}),(function(e){return e.theme.secondary.contrastText}),(function(e){return e.theme.secondary.dark})),Ce=Object(D.b)(ye)(y||(y=Object(l.a)(["\n  animation: "," 1s linear infinite;\n"])),we),ke=Object(D.b)(ye)(C||(C=Object(l.a)(["\n  animation: "," 0.7s linear infinite;\n"])),ve),De=t(116),Ie=function(e,n){return e.length>n?e.substring(0,n)+"...":e};var Re,Se,Te,Ae,Pe,Ee,Fe,Me,ze,Le,Be,_e,Ne,Ue,We,He,$e,Je,Ge,Ye,Xe=function(e){e.length>5?E.b.error("The maximum number of transfer files is set up to ".concat(5)):e.forEach((function(e){var n=e.file,t=e.errors;E.b.error("Unable to transfer ".concat(Ie(n.name,9)).concat(t.find((function(e){return"file-too-large"===e.code}))?". The maximum size per file is set up to 16mb":""))}))},qe=function(e){var n=e.shouldDisableActionBtn,t=e.handleFileInputChange,r=a.a.useState(null),o=Object(s.a)(r,2),c=o[0],i=o[1],l=Object(De.a)({maxFiles:5,maxSize:Y,disabled:n,onDragEnter:function(){return i("drag")},onDragLeave:function(){return i(null)},onDropAccepted:t,onDropRejected:Xe}),u=l.getRootProps,d=l.getInputProps;return a.a.useEffect((function(){n&&i(null)}),[n]),{getRootProps:u,getInputProps:d,onMouseEnter:function(){return i("mouse")},onMouseLeave:function(){return i(null)},enterType:c}},Ke=D.b.div(Re||(Re=Object(l.a)(["\n  z-index: 1;\n  position: fixed;\n  bottom: 1em;\n  left: 50%;\n  transform: translateX(-50%);\n  padding-left: ",";\n"])),(function(e){return e.theme.drawerMinWidth})),Qe=D.b.div(Se||(Se=Object(l.a)(["\n  font-size: 14px;\n  color: ",";\n  text-transform: capitalize;\n"])),(function(e){return e.theme.primary.contrastText})),Ve=function(e){var n=e.selfIdentity,t=e.shouldDisableActionBtn,r=e.handleFileInputChange,o=a.a.useRef(null),c=qe({shouldDisableActionBtn:t,handleFileInputChange:r}),s=c.getRootProps,l=c.getInputProps,u=c.onMouseEnter,d=c.onMouseLeave,p=c.enterType;return Object(K.jsxs)(Ke,{children:[Object(K.jsxs)("div",Object(i.a)(Object(i.a)({},s()),{},{children:[Object(K.jsxs)(ke,{className:"peerBtn",ref:o,onMouseEnter:u,onMouseLeave:d,onClick:function(){return document.getElementById("fileInput-self").value=""},variant:"contained",children:[Object(K.jsx)("span",{children:n.emoji}),Object(K.jsx)("input",Object(i.a)({id:"fileInput-self"},l()))]}),Object(K.jsxs)(Qe,{children:["You: ",n.platform,"-",n.browser]})]})),Object(K.jsx)(Oe,{isSelf:!0,enterType:p,anchorElement:o.current})]})},Ze=t(42),en=t(59),nn=D.b.div(Te||(Te=Object(l.a)(["\n  position: relative;\n  font-size: 14px;\n  color: ",";\n  text-transform: capitalize;\n  min-width: max-content;\n  left: 50%;\n  transform: translateX(-50%);\n"])),(function(e){return e.theme.primary.contrastText})),tn=function(e){var n=e.shouldDisableActionBtn,t=e.handleFileInputChange,r=e.targetPeer,o=e.onPeerDrop,c=e.setAnchorElement,s=a.a.useRef(null),l=qe({shouldDisableActionBtn:n,handleFileInputChange:t}),u=l.getRootProps,d=l.getInputProps,p=l.onMouseEnter,b=l.onMouseLeave,f=l.enterType;a.a.useEffect((function(){return function(){o()}}),[]),a.a.useEffect((function(){s.current&&c(s.current)}),[s,c]);return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("div",Object(i.a)(Object(i.a)({},u()),{},{children:Object(K.jsxs)(Ce,{className:"peerBtn",ref:s,disabled:n,onMouseOver:p,onMouseLeave:b,onClick:function(){return document.getElementById("fileInput-".concat(r.id)).value=""},variant:"contained",children:[Object(K.jsx)("input",Object(i.a)({id:"fileInput-".concat(r.id)},d())),Object(K.jsx)("span",{children:r.emoji})]})})),Object(K.jsxs)(nn,{children:[r.platform,"-",r.browser]}),f&&Object(K.jsx)(Oe,{isSelf:!1,enterType:f,anchorElement:s.current})]})},rn=D.b.div(Ae||(Ae=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  margin-top: 1em;\n"]))),an=D.b.div(Pe||(Pe=Object(l.a)(["\n  width: 100%;\n  margin-right: 1em;\n  flex-grow: 1;\n  --progress-color: ",";\n  progress {\n    width: 100%;\n    color: var(--progress-color);\n  }\n  progress[value] {\n    /* Reset the default progress */\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    appearance: none;\n    border: none;\n    height: 12px;\n  }\n  progress[value]::-moz-progress-bar {\n    background-color: var(--progress-color);\n  }\n  progress::-webkit-progress-value {\n    border-radius: 4px;\n    background-color: var(--progress-color);\n  }\n  progress::-webkit-progress-bar {\n    border-radius: 4px;\n    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.25) inset;\n  }\n"])),(function(e){return e.theme.secondary.light})),on=D.b.div(Ee||(Ee=Object(l.a)(["\n  width: 44px;\n  color: ",";\n"])),(function(e){return e.theme.secondary.light})),cn=function(e){return Object(K.jsxs)(rn,{children:[Object(K.jsx)(an,{children:Object(K.jsx)("progress",{max:"100",value:e.progress})}),Object(K.jsx)(on,{children:"".concat(e.progress,"%")})]})},sn=a.a.createContext({shouldAutoAccept:!1,shouldAutoDownload:!1,appTheme:"dark",toggleAutoAccept:function(){},toggleAutoDownload:function(){},toggleLightDarkTheme:function(){}}),ln=function(e){var n=e.children,t=function(){var e=Object(r.useState)(!1),n=Object(s.a)(e,2),t=n[0],a=n[1],o=Object(r.useState)(!1),c=Object(s.a)(o,2),i=c[0],l=c[1];return Object(r.useEffect)((function(){var e=window.localStorage.getItem(J),n=window.localStorage.getItem(G),t=!("false"===n||!n);a(!("false"===e||!e)),l(t)}),[]),{shouldAutoAccept:t,shouldAutoDownload:i,toggleAutoAccept:function(){window.localStorage.setItem(J,(!t).toString()),a(!t)},toggleAutoDownload:function(){window.localStorage.setItem(G,(!i).toString()),l(!i)}}}(),a=t.shouldAutoAccept,o=t.shouldAutoDownload,c=t.toggleAutoAccept,i=t.toggleAutoDownload,l=function(){var e=Object(r.useState)("dark"),n=Object(s.a)(e,2),t=n[0],a=n[1];return Object(r.useEffect)((function(){var e=window.localStorage.getItem($);e?a(e):window.localStorage.setItem($,"dark")}),[]),{appTheme:t,toggleLightDarkTheme:function(){var e="dark"===t?"light":"dark";window.localStorage.setItem($,e),a(e)}}}(),u=l.appTheme,d=l.toggleLightDarkTheme;return Object(K.jsx)(sn.Provider,{value:{shouldAutoAccept:a,shouldAutoDownload:o,appTheme:u,toggleAutoAccept:c,toggleAutoDownload:i,toggleLightDarkTheme:d},children:n})},un={isOpen:!1,progressType:null,fileProgress:0,downloadableFiles:[]},dn=function(e,n){switch(n.type){case"clear":return Object(i.a)({},un);case"set_received_progress":return Object(i.a)(Object(i.a)({},e),{},{isOpen:!0,progressType:"receive",fileProgress:n.payload.progress});case"set_sent_progress":return Object(i.a)(Object(i.a)({},e),{},{isOpen:!0,progressType:"send",fileProgress:n.payload.progress});case"set_downloadableFiles":return Object(i.a)(Object(i.a)({},e),{},{downloadableFiles:[].concat(Object(en.a)(e.downloadableFiles),[n.payload.downloadableFile])});default:return e}},pn=function(e){var n=e.targetPeer,t=e.setClose,r=e.fileProgress,o=e.downloadableFiles,c=e.progressType,i=e.anchorElement,l=e.onCancelFileTransfer,u=e.shouldAutoDownload,d=a.a.useState(null),p=Object(s.a)(d,2),b=p[0],f=p[1],h=a.a.useState(null),j=Object(s.a)(h,2),m=j[0],O=j[1],g=me();a.a.useEffect((function(){O(o)}),[o]),a.a.useEffect((function(){u&&100===r&&t()}),[u,r]);var x=function(){l(),w()},w=function(){return t()};return Object(K.jsxs)(ce.a,{open:!!i,anchorEl:i,placement:"top",className:g.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{element:b}},children:[Object(K.jsx)("div",{className:g.arrow,ref:f}),Object(K.jsx)(se,{children:"receive"===c?Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(le,{children:u?"Download Progress: ":"Downloadable file will show below"}),Object(K.jsxs)(de,{children:[m&&m.map((function(e,r){return Object(K.jsx)(fe,{children:Object(K.jsxs)(he,{onClick:function(){return function(e){setTimeout((function(){return window.URL.revokeObjectURL(e.fileBlobUrl)}),0);var n=m.filter((function(n){return n.fileBlobUrl!==e.fileBlobUrl}));n.length>0?O(n):t()}(e)},download:e.fileName,href:e.fileBlobUrl,children:["Download ",e.fileName]})},"".concat(n.id,"-download-").concat(r))})),0!==r&&Object(K.jsx)(cn,{progress:r})]}),Object(K.jsx)(pe,{children:100===r?Object(K.jsx)(be,{variant:"outlined",size:"small",onClick:w,color:"secondary",children:"close"}):Object(K.jsx)(be,{variant:"outlined",size:"small",onClick:x,color:"secondary",children:"cancel"})})]}):Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(le,{children:"Sending..."}),Object(K.jsxs)(de,{children:[Object(K.jsx)("div",{children:"Waiting for file transfer to complete..."}),Object(K.jsx)(cn,{progress:r})]}),Object(K.jsx)(pe,{children:Object(K.jsx)(be,{variant:"outlined",onClick:x,color:"secondary",children:"cancel"})})]})})]})},bn=function(e){return Object(K.jsx)(sn.Consumer,{children:function(n){var t=n.shouldAutoDownload;return Object(K.jsx)(pn,Object(i.a)(Object(i.a)({},e),{},{shouldAutoDownload:t}))}})},fn=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(n)+" "+["B","Kib","Mib","Gib","Tib"][t]},hn={isOpen:!1,fileMetas:null},jn=function(e,n){switch(n.type){case"clear":return Object(i.a)({},hn);case"set_file_metas":return{isOpen:!0,fileMetas:n.payload.fileMetas};default:return e}},mn=function(e){var n=e.setClose,t=e.anchorElement,r=e.fileMetas,o=e.targetPeer,c=e.onCancelFileTransfer,i=e.onAcceptFileTransfer,l=a.a.useState(null),u=Object(s.a)(l,2),d=u[0],p=u[1],b=me();return Object(K.jsxs)(ce.a,{open:!!t,anchorEl:t,placement:"top",className:b.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{element:d}},children:[Object(K.jsx)("div",{className:b.arrow,ref:p}),Object(K.jsxs)(se,{children:[Object(K.jsxs)(le,{children:[o.emoji," from ",o.platform," ",o.browser," wants to send:"]}),Object(K.jsx)(de,{children:null===r||void 0===r?void 0:r.map((function(e,n){return Object(K.jsxs)(ue,{children:[e.name," (",fn(e.size),")"]},"".concat(o.id,"-meta-").concat(n))}))}),Object(K.jsxs)(pe,{children:[Object(K.jsx)(be,{variant:"contained",size:"small",onClick:function(){i(),n()},color:"secondary",children:"Accept"}),Object(K.jsx)(be,{variant:"outlined",size:"small",onClick:function(){c(),n()},color:"secondary",children:"Decline"})]})]})]})},On={isOpen:!1,gotRemoteDesc:!1},gn=function(e,n){switch(n.type){case"clear":return Object(i.a)({},On);case"set_open_with_desc":return{isOpen:!0,gotRemoteDesc:!0};case"set_open_without_desc":return{isOpen:!0,gotRemoteDesc:!1};case"set_desc":return Object(i.a)(Object(i.a)({},e),{},{gotRemoteDesc:!0});default:return e}},xn=function(e){var n=e.targetPeer,t=e.gotRemoteDesc,r=e.anchorElement,o=a.a.useState(null),c=Object(s.a)(o,2),i=c[0],l=c[1],u=me();return a.a.useEffect((function(){var e;return sessionStorage.setItem(W,"1"),t&&(e=setTimeout((function(){sessionStorage.setItem(U,"1"),window.location.reload()}),6e3)),function(){clearTimeout(e),sessionStorage.removeItem(W)}}),[t]),Object(K.jsxs)(ce.a,{open:!!r,anchorEl:r,placement:"top",className:u.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{element:i}},children:[Object(K.jsx)("div",{className:u.arrow,ref:l}),Object(K.jsx)(se,{children:Object(K.jsx)(le,{children:t?"Preparing data channel with ".concat(n.emoji,"..."):"Waiting for ".concat(n.emoji,"'s response...")})})]})},wn=function(e){var n=e.publicID,t=e.firestoreDbRef,a=e.connectionIdRef,o=e.peerConnectionRef,c=e.callerUnsubscriberRef,i=e.dispatchProgressPopperData,s=e.dispatchWaitResponsePopperData,l=e.handleDownloadFile,u=e.clearSignalService,d=Object(r.useRef)(null),p=Object(r.useCallback)((function(){s({type:"clear"}),d.current&&(d.current.close(),console.log("Closed receive data channel with label: ".concat(d.current.label))),u()}),[d,s,u]),b=Object(r.useCallback)((function(){o.current.ondatachannel=function(e){console.log("Receive Channel Callback"),d.current=e.channel,d.current.binaryType="arraybuffer",d.current.onmessage=h,d.current.onopen=m,d.current.onclose=m};var e=t.collection(z).doc(n).collection(L).doc(a.current),r=0,c=0,u=0,b=0,f=[];function h(e){return j.apply(this,arguments)}function j(){return(j=Object(ne.a)(ee.a.mark((function n(t){var a,o,s,d,h,j,m,O;return ee.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.get();case 2:if((a=n.sent).data()){n.next=5;break}return n.abrupt("return");case 5:f.push(t.data),c+=t.data.byteLength,b+=t.data.byteLength,o=a.data().fileMetas,s=o.reduce((function(e,n){return e+n.size}),0),d=o[u],h=d.name,j=d.size,m=Math.round(c/s*100),i({type:"set_received_progress",payload:{progress:m}}),b===j&&(O=new Blob(f),f=[],b=0,u+=1,l(O,h)),c===s&&(r=1,p());case 15:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function m(){return O.apply(this,arguments)}function O(){return(O=Object(ne.a)(ee.a.mark((function e(){var n;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.current&&(n=d.current.readyState,console.log("Receive channel state is: ".concat(n)),"open"===n&&s({type:"clear"}),"closed"===n&&(r||E.b.warn("File transfer is cancelled"),r=0,d.current=null));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}),[a,t,o,d,n,i,s,l,p]);return{receiveChannelRef:d,joinTransferChannel:function(){var e=Object(ne.a)(ee.a.mark((function e(r){var i,s,l,u,d,p,f,h;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.collection(z).doc(n),s=i.collection(L).doc(r),e.next=4,s.get();case 4:if(!(l=e.sent).exists){e.next=25;break}return a.current=r,o.current=new RTCPeerConnection(M),b(),u=s.collection(B),o.current.addEventListener("icecandidate",(function(e){e.candidate?u.add(e.candidate.toJSON()):console.log("Got final candidate!")})),d=s.collection(_).onSnapshot((function(e){e.docChanges().forEach(function(){var e=Object(ne.a)(ee.a.mark((function e(n){var t;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==n.type){e.next=6;break}return t=n.doc.data(),console.log("Got new remote ICE candidate: ".concat(JSON.stringify(t))),console.log(o.current),e.next=6,o.current.addIceCandidate(new RTCIceCandidate(t));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())})),c.current=d,p=l.data().offer,console.log("Got offer:",p),e.next=17,o.current.setRemoteDescription(new RTCSessionDescription(p));case 17:return e.next=19,o.current.createAnswer();case 19:return f=e.sent,console.log("Created answer:",f),e.next=23,o.current.setLocalDescription(f);case 23:h={answer:{type:f.type,sdp:f.sdp},isAccepting:!0},s.update(h);case 25:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}},vn=function(e){var n=e.localID,t=e.publicID,a=e.firestoreDbRef,o=e.connectionIdRef,c=e.peerConnectionRef,s=e.calleeUnsubscriberRef,l=e.descriptionUnsubscriberRef,u=e.totalFileSizeRef,d=e.sentFileReaderRef,p=e.acceptedFileListRef,b=e.dispatchWaitResponsePopperData,f=e.dispatchProgressPopperData,h=Object(r.useRef)(null),j=Object(r.useCallback)(Object(ne.a)(ee.a.mark((function e(){var n,t,r,a,o,i,s,l,b,j;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b=function(){E.b.success("File has been transferred"),i=0,s=0,l=0,f({type:"clear"}),p.current=[]},p.current&&0!==p.current.length){e.next=3;break}return e.abrupt("return");case 3:console.log("Sending files:",p.current),r=Object(en.a)(p.current),a=null===(n=c.current)||void 0===n||null===(t=n.sctp)||void 0===t?void 0:t.maxMessageSize,console.log("maximum message size is: ",a),o=a||16384,i=0,s=0,l=0,d.current=new FileReader,d.current.addEventListener("error",(function(e){console.error("Error reading file:",e),E.b.error("Failed to read file: ".concat(r[s].name))})),d.current.addEventListener("abort",(function(e){console.log("File reading aborted:",e),E.b.warn("Abort file read: ".concat(r[s].name))})),d.current.addEventListener("load",(function(e){var n=e.target.result;h.current.send(n),l+=n.byteLength,i+=n.byteLength;var t=Math.round(l/u.current*100);f({type:"set_sent_progress",payload:{progress:t}}),l<u.current?function e(){h.current.bufferedAmount+n.byteLength<16777216?j(i):setTimeout(e,500)}():(console.log("transfer done"),b())})),(j=function(e){var n;if(e<r[s].size){var t=e+o;t>r[s].size&&(t=r[s].size),n=r[s].slice(i,t)}else{if(i=0,!r[s+=1])return void b();n=r[s].slice(i,o)}d.current.readAsArrayBuffer(n)})(0);case 17:case"end":return e.stop()}}),e)}))),[h,u,d,p,c,f]),m=Object(r.useCallback)((function(){function e(){if(h.current){var e=h.current.readyState;console.log("Send channel state is: ".concat(e)),"open"===e&&(j(),b({type:"clear"})),"closed"===e&&(h.current=null)}}h.current=c.current.createDataChannel("sendDataChannel"),console.log("Created send data channel: ",h.current),h.current.binaryType="arraybuffer",h.current.onopen=e,h.current.onclose=e,h.current.onerror=function(e){if(h.current)return void console.error("Error in sendChannel:",e);console.log("Error in sendChannel which is already closed:",e)}}),[c,h,j,b]);return{sendChannelRef:h,tryCreatePeerConnection:function(){var e=Object(ne.a)(ee.a.mark((function e(r){var u,d,p,f,h,j,O,g,x;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=a.collection(z).doc(t),d=u.collection(L),p=d.doc(),f={p2p:{offer:n,answer:r.id}},h=p.collection(_),c.current=new RTCPeerConnection(M),o.current=p.id,m(),c.current.addEventListener("icecandidate",(function(e){e.candidate?h.add(e.candidate.toJSON()):console.log("Got final candidate!")})),j=p.onSnapshot(function(){var e=Object(ne.a)(ee.a.mark((function e(n){var t,r;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=n.data())&&t.answer){e.next=3;break}return e.abrupt("return");case 3:if(!c.current||c.current.currentRemoteDescription){e.next=8;break}return r=new RTCSessionDescription(t.answer),e.next=7,c.current.setRemoteDescription(r);case 7:b({type:"set_desc"});case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),l.current=j,O=p.collection(B).onSnapshot((function(e){e.docChanges().forEach(function(){var e=Object(ne.a)(ee.a.mark((function e(n){var t;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==n.type){e.next=4;break}return t=n.doc.data(),e.next=4,c.current.addIceCandidate(new RTCIceCandidate(t));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())})),s.current=O,e.next=15,c.current.createOffer();case 15:return g=e.sent,e.next=18,c.current.setLocalDescription(g);case 18:return console.log("Created offer:",g),x={offer:{type:g.type,sdp:g.sdp},isAccepting:!1},e.next=22,p.set(Object(i.a)(Object(i.a)({},x),f));case 22:b({type:"set_open_without_desc"});case 23:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}},yn=function(e){var n=e.targetPeer,t=e.localID,a=e.publicID,o=e.firestoreDbRef,c=e.sendAllFiles,l=e.clearSentAllFiles,u=Object(r.useRef)(!0),d=Object(r.useRef)(null),p=Object(r.useRef)(null),b=Object(r.useRef)(null),f=Object(r.useRef)(0),h=Object(r.useRef)([]),j=Object(r.useRef)(),m=Object(r.useRef)(),O=Object(r.useRef)(),g=Object(r.useState)(null),x=Object(s.a)(g,2),w=x[0],v=x[1],y=Object(r.useReducer)(gn,On),C=Object(s.a)(y,2),k=C[0],D=C[1],I=Object(r.useReducer)(jn,hn),R=Object(s.a)(I,2),S=R[0],T=R[1],A=Object(r.useReducer)(dn,un),P=Object(s.a)(A,2),F=P[0],M=P[1],U=Object(r.useMemo)((function(){return k.isOpen||S.isOpen||F.isOpen}),[k.isOpen,S.isOpen,F.isOpen]);Object(r.useEffect)((function(){var e=o.collection(z).doc(a).collection(L).onSnapshot(function(){var e=Object(ne.a)(ee.a.mark((function e(r){return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.docChanges().forEach(function(){var e=Object(ne.a)(ee.a.mark((function e(r){var a,o;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.doc.data(),"modified"===r.type&&!a.isAccepting&&!a.answer&&a.fileMetas&&a.p2p&&a.p2p.answer===t&&a.p2p.offer===n.id&&ie(a.fileMetas,r.doc.id),"removed"===r.type&&(o=r.doc.id,console.log("remove connection: "),console.log(o,p.current),o!==p.current||!a.p2p||a.p2p.answer!==t&&a.p2p.offer!==t||Z(!0));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());return function(){e(),Z(!1),te(),sessionStorage.getItem(W)&&(E.b.warn("Peer connection dropped"),sessionStorage.removeItem(W))}}),[]),Object(r.useEffect)((function(){u.current?u.current=!1:(re(Object(en.a)(c)),l())}),[u,c]);var H=Object(r.useCallback)(Object(ne.a)(ee.a.mark((function e(){var n,t,r;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j.current&&j.current(),m.current&&m.current(),O.current&&O.current(),!(n=p.current)){e.next=18;break}return t=o.collection(z).doc(a),r=t.collection(L).doc(n),e.next=9,r.collection(B).get();case 9:return e.sent.forEach(function(){var e=Object(ne.a)(ee.a.mark((function e(n){return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref.delete();case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.next=13,r.collection(_).get();case 13:return e.sent.forEach(function(){var e=Object(ne.a)(ee.a.mark((function e(n){return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref.delete();case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.next=17,r.delete();case 17:p.current=null;case 18:case"end":return e.stop()}}),e)}))),[o,p,j,m,O,a]),$=wn({publicID:a,firestoreDbRef:o,connectionIdRef:p,peerConnectionRef:d,callerUnsubscriberRef:j,dispatchProgressPopperData:M,dispatchWaitResponsePopperData:D,handleDownloadFile:function(e,n){if("true"===window.localStorage.getItem(G)){var t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=n,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(t.href),document.body.removeChild(t)}else M({type:"set_downloadableFiles",payload:{downloadableFile:{fileName:n,fileBlobUrl:URL.createObjectURL(e)}}})},clearSignalService:H}),Y=$.receiveChannelRef,X=$.joinTransferChannel,q=vn({localID:t,publicID:a,firestoreDbRef:o,connectionIdRef:p,peerConnectionRef:d,calleeUnsubscriberRef:m,descriptionUnsubscriberRef:O,totalFileSizeRef:f,sentFileReaderRef:b,acceptedFileListRef:h,dispatchProgressPopperData:M,dispatchWaitResponsePopperData:D}),Q=q.sendChannelRef,V=q.tryCreatePeerConnection,Z=Object(r.useCallback)((function(e){D({type:"clear"}),Q.current&&(Q.current.close(),e&&E.b.warn("File transfer is closed"),console.log("Closed send data channel with label: ".concat(Q.current.label))),Y.current&&(Y.current.close(),console.log("Closed receive data channel with label: ".concat(Y.current.label))),H()}),[Q,Y,H]),te=Object(r.useCallback)((function(){d.current&&(console.log("closing peers connection"),d.current.close(),d.current=null)}),[d]);function re(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(ne.a)(ee.a.mark((function e(t){var r,c,i,s,l,u;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=13;break}return h.current=t,e.next=4,V(n);case 4:return r=p.current,c=o.collection(z).doc(a),i=c.collection(L),s=i.doc(r),l=[],t.forEach((function(e){l.push({name:e.name,size:e.size,type:e.type}),f.current+=e.size})),u=Object(Ze.a)({},N,l),e.next=13,s.update(u);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oe=function(){X(p.current),k.isOpen||D({type:"set_open_with_desc"})},ce=function(){b.current&&1===b.current.readyState&&(console.log("Abort file read..."),b.current.abort()),S.isOpen&&T({type:"clear"}),Z(!1)},ie=function(){var e=Object(ne.a)(ee.a.mark((function e(t,r){var a;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("incoming file metas:",t),console.log("got from:",n),p.current=r,a=window.localStorage.getItem(J),"true"===a?oe():T({type:"set_file_metas",payload:{fileMetas:t}});case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();return Object(K.jsxs)("div",{className:"peerHolder",children:[Object(K.jsx)(tn,{shouldDisableActionBtn:U,handleFileInputChange:re,targetPeer:n,onPeerDrop:H,setAnchorElement:v}),k.isOpen&&Object(K.jsx)(xn,Object(i.a)(Object(i.a)({},k),{},{targetPeer:n,anchorElement:w})),F.isOpen&&Object(K.jsx)(bn,Object(i.a)(Object(i.a)({},F),{},{onCancelFileTransfer:ce,targetPeer:n,setClose:function(){return M({type:"clear"})},anchorElement:w})),S.isOpen&&Object(K.jsx)(mn,Object(i.a)(Object(i.a)({},S),{},{onAcceptFileTransfer:oe,onCancelFileTransfer:ce,targetPeer:n,setClose:function(){return T({type:"clear"})},anchorElement:w}))]})},Cn=t(159),kn=D.b.p(Fe||(Fe=Object(l.a)(["\n  color: ",";\n  margin-top: ",";\n  height: ",";\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  max-width: 80%;\n  span {\n    font-size: 12px;\n  }\n"])),(function(e){return e.theme.primary.contrastText}),(function(e){return e.$shouldHide?"0px":"25%"}),(function(e){return e.$shouldHide?"0px":"auto"})),Dn=Object(D.b)(oe)(Me||(Me=Object(l.a)(["\n  position: relative;\n  height: 100%;\n  width: 100%;\n  z-index: 1;\n  overflow-y: auto;\n  padding-top: 1em;\n  padding-bottom: 100px;\n  @media only screen and (",") {\n    padding-bottom: 0;\n    margin-bottom: 120px;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-around;\n  }\n"])),ae.sm),In=function(e){var n=e.selfIdentity,t=e.publicID,o=e.localID,c=Object(r.useState)([]),i=Object(s.a)(c,2),l=i[0],u=i[1],d=Object(r.useState)([]),p=Object(s.a)(d,2),b=p[0],f=p[1],h=a.a.useRef(k.firestore());function j(){b.length>0&&f([])}Object(r.useEffect)((function(){var e=k.database().ref("".concat(t));return e.on("value",function(){var e=Object(ne.a)(ee.a.mark((function e(n){var t,r,a;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=n.val(),r=[],t)a!==o&&r.push(t[a]);r.length>10?(E.b.dismiss(),E.b.warn("The maximum concurrent peers is set to ".concat(10))):u(r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),function(){e.off()}}),[t]);var m=0===l.length;return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(Cn.a,{in:m,children:Object(K.jsxs)(kn,{$shouldHide:!m,children:["Open the same link to start transfer files",Object(K.jsx)("br",{}),Object(K.jsx)("span",{children:"swipe right or click drawer icons to see or toggle app settings"})]})}),Object(K.jsx)(Cn.a,{in:!m,children:Object(K.jsx)(Dn,{children:l.map((function(e){return Object(K.jsx)(yn,{clearSentAllFiles:j,sendAllFiles:b,firestoreDbRef:h.current,targetPeer:e,publicID:t,localID:o},e.id)}))})}),n&&Object(K.jsx)(Ve,{shouldDisableActionBtn:b.length>0,handleFileInputChange:function(e){0===l.length?(E.b.warn("There is no other peers in this room"),j()):f(e)},publicID:t,localID:o,selfIdentity:n})]})},Rn=Object(r.memo)(In),Sn=t(6),Tn=t(222),An=t(208),Pn=t(207),En=t(111),Fn=t.n(En),Mn=t(205),zn=t(112),Ln=t.n(zn),Bn=t(219),_n={light:{primary:{main:"#f1f0ea",light:"#f3f3ee",dark:"#d7d7d3",contrastText:"#025855"},secondary:{main:"#cd5521",dark:"#8f3b17",light:"#d7774d",contrastText:"#fff"}},dark:{primary:{main:"#303846",light:"#595f6b",dark:"#212731",contrastText:"#fff"},secondary:{main:"#1565C0",dark:"#0e4686",light:"#4383cc",contrastText:"#fff"}}},Nn=Object(i.a)({drawerMinWidth:"55px"},_n.dark),Un=Object(je.a)((function(e){return Object(Bn.a)({hide:{display:"none"},drawer:{flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:290,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:{width:Nn.drawerMinWidth,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflow:"hidden"},titleText:{fontSize:22,position:"absolute",left:16},titleBar:{display:"flex",alignItems:"center",height:60,justifyContent:"flex-end"}})})),Wn=t(204),Hn=t(203),$n=t(202),Jn=t(206),Gn=t(220),Yn=t(221),Xn=t(107),qn=t.n(Xn),Kn=t(110),Qn=t.n(Kn),Vn=t(109),Zn=t.n(Vn),et=t(103),nt=t.n(et),tt=t(104),rt=t.n(tt),at=t(101),ot=t.n(at),ct=t(102),it=t.n(ct),st=t(105),lt=t.n(st),ut=t(106),dt=t.n(ut),pt=t(108),bt=t.n(pt),ft=Object(D.b)($n.a)(ze||(ze=Object(l.a)(["\n  margin-right: -16px;\n  color: "," !important;\n"])),(function(e){return e.theme.primary.contrastText})),ht=Object(D.b)(Hn.a)(Le||(Le=Object(l.a)(["\n  margin-top: 4px;\n  justify-content: space-between !important;\n  line-height: 1.5em;\n  cursor: pointer;\n  padding: 0.5em 1em;\n  font-size: 14px;\n  text-align: left;\n  padding-bottom: 1em;\n  visibility: ",";\n  * {\n    pointer-events: none;\n  }\n  span {\n    font-weight: 300;\n  }\n  input {\n    min-width: 200px;\n    pointer-events: auto;\n    color: ",";\n  }\n"])),(function(e){return e.$isOpen?"visible":"hidden"}),(function(e){return e.theme.primary.contrastText})),jt=Object(D.b)(Wn.a)(Be||(Be=Object(l.a)(["\n  margin-top: auto !important;\n"]))),mt=function(e){var n=e.publicID,t=e.drawerOpen,r=e.shouldAutoAccept,a=e.shouldAutoDownload,o=e.appTheme,c=e.toggleAutoAccept,i=e.toggleAutoDownload,s=e.toggleLightDarkTheme,l=e.handleJoinRoomModalOpen,u=e.handleAboutModalOpen,d=function(){var e=Object(ne.a)(ee.a.mark((function e(t){return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),e.prev=1,e.next=4,navigator.clipboard.writeText(n);case 4:E.b.dismiss(),E.b.info("Room Id copied",{autoClose:3e3}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),document.getElementById(X).select();case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}();return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsxs)(Wn.a,{children:[Object(K.jsx)(Mn.a,{title:"Auto Accept",placement:"right",children:Object(K.jsxs)(Hn.a,{button:!0,onClick:c,children:[Object(K.jsx)(ft,{children:r?Object(K.jsx)(ot.a,{}):Object(K.jsx)(it.a,{})}),Object(K.jsx)(Jn.a,{primary:"Auto Accept Request"}),Object(K.jsx)(Gn.a,{checked:r,inputProps:{"aria-label":"secondary checkbox"}})]})}),Object(K.jsx)(Mn.a,{title:"Auto Download",placement:"right",children:Object(K.jsxs)(Hn.a,{button:!0,onClick:i,children:[Object(K.jsx)(ft,{children:a?Object(K.jsx)(nt.a,{}):Object(K.jsx)(rt.a,{})}),Object(K.jsx)(Jn.a,{primary:"Auto Download File"}),Object(K.jsx)(Gn.a,{checked:a,inputProps:{"aria-label":"secondary checkbox"}})]})})]}),Object(K.jsx)(An.a,{}),Object(K.jsxs)(Wn.a,{children:[Object(K.jsx)(Mn.a,{title:"Brightness Theme",placement:"right",children:Object(K.jsxs)(Hn.a,{button:!0,onClick:s,children:[Object(K.jsx)(ft,{children:"light"===o?Object(K.jsx)(lt.a,{}):Object(K.jsx)(dt.a,{})}),Object(K.jsx)(Jn.a,{primary:"Light / Dark Theme"})]})}),Object(K.jsx)(Mn.a,{title:"Join Another Room",placement:"right",children:Object(K.jsxs)(Hn.a,{button:!0,onClick:l,children:[Object(K.jsx)(ft,{children:Object(K.jsx)(qn.a,{})}),Object(K.jsx)(Jn.a,{primary:"Join a room"})]})})]}),Object(K.jsx)(An.a,{}),Object(K.jsx)(Wn.a,{children:Object(K.jsxs)(ht,{button:!0,id:q,$isOpen:t,onClick:function(e){return d(e)},children:[Object(K.jsxs)("div",{children:[Object(K.jsx)("span",{children:"Room ID:"}),Object(K.jsx)("br",{}),Object(K.jsx)(Yn.a,{id:X,value:n,inputProps:{"aria-label":"naked"}})]}),Object(K.jsx)(ft,{children:Object(K.jsx)(bt.a,{})})]})}),Object(K.jsxs)(jt,{children:[Object(K.jsx)(Mn.a,{title:"About",placement:"right",children:Object(K.jsxs)(Hn.a,{button:!0,onClick:u,children:[Object(K.jsx)(ft,{children:Object(K.jsx)(Zn.a,{})}),Object(K.jsx)(Jn.a,{primary:"About"})]})}),Object(K.jsx)(Mn.a,{title:"Source Code",placement:"right",children:Object(K.jsxs)(Hn.a,{button:!0,onClick:function(){return window.open("https://github.com/haooowu/PeerTransfer")},children:[Object(K.jsx)(ft,{children:Object(K.jsx)(Qn.a,{})}),Object(K.jsx)(Jn.a,{primary:"Source"})]})})]})]})},Ot=function(e){return Object(K.jsx)(Q.Consumer,{children:function(n){var t=n.publicID;return Object(K.jsx)(mt,Object(i.a)({publicID:t},e))}})},gt=t(217),xt=t(210),wt=t(209),vt=t(212),yt=t(213),Ct=t(211),kt=Object(D.b)(wt.a)(_e||(_e=Object(l.a)(["\n  padding: 8px 16px !important;\n"]))),Dt=new RegExp(/^[a-zA-Z0-9+/=]+$/),It=function(e){var n=e.open,t=e.handleClose,r=a.a.useState(""),o=Object(s.a)(r,2),c=o[0],i=o[1];return Object(K.jsxs)(xt.a,{open:n,onClose:t,children:[Object(K.jsx)(Ct.a,{children:"Join or Create Room"}),Object(K.jsxs)(vt.a,{children:[Object(K.jsx)(yt.a,{children:"You can find current room ID by expand the side drawer"}),Object(K.jsx)(gt.a,{onChange:function(e){var n=e.target.value;(Dt.test(n)||""===n)&&i(n)},value:c,autoFocus:!0,color:"secondary",margin:"dense",label:"Room ID",type:"text",fullWidth:!0})]}),Object(K.jsxs)(kt,{children:[Object(K.jsx)(ie.a,{onClick:t,color:"secondary",children:"Cancel"}),Object(K.jsx)(ie.a,{onClick:function(){!c.trim()||c.length<1||c.length>30?E.b.error("Invalid room id format"):(sessionStorage.setItem(H,c),window.location.reload())},color:"secondary",children:"Confirm"})]})]})},Rt=t(214),St=D.b.div(Ne||(Ne=Object(l.a)(["\n  font-weight: bold;\n  font-size: 12px;\n  text-transform: uppercase;\n  margin-bottom: 1em;\n"]))),Tt=function(e){var n=e.open,t=e.handleClose;return Object(K.jsx)(xt.a,{open:n,onClose:t,children:Object(K.jsxs)(vt.a,{children:[Object(K.jsx)(St,{children:"About"}),Object(K.jsxs)(yt.a,{children:["This App uses ",Object(K.jsx)("strong",{children:"WebRTC"})," for secure end-to-end peer connection (you can"," ",Object(K.jsx)(Rt.a,{href:"https://test.webrtc.org/",rel:"noreferrer",target:"_blank",children:"test here"}),"), together with free STUN server from Google, and Firebase for signalling service and peer presence management. Only the following data is used by Firebase for WebRTC signalling:",Object(K.jsxs)("ul",{children:[Object(K.jsx)("li",{children:"File metadata including file name, size and type"}),Object(K.jsx)("li",{children:"ICE candidate descriptions, offers and answers that contain SDP information."}),Object(K.jsx)("li",{children:"Your public IP address is also used and served as the default room ID (in base64 encoded format). "})]}),"You can also join another network room by entering their ID, or create custom ones from your own."]}),Object(K.jsx)(St,{children:"Get Started"}),Object(K.jsx)(yt.a,{children:"Peers in the same network or room ID should appear in the app with their device and browser info, start transfer file by drag and drop files or click their emoji to select files for transfer."}),Object(K.jsx)(yt.a,{children:"You can swipe right or click the drawer menu icon to see the app settings and your current room ID."}),Object(K.jsxs)(yt.a,{children:["Maximum file size is set to ",Object(K.jsx)("strong",{children:fn(Y,0)}),", with up to"," ",Object(K.jsx)("strong",{children:5})," file peer transfer and up to ",Object(K.jsx)("strong",{children:10})," ","peers each room."]})]})})},At=Object(D.b)(Pn.a)(Ue||(Ue=Object(l.a)(["\n  width: ",";\n  height: ",";\n  color: "," !important;\n"])),(function(e){return e.theme.drawerMinWidth}),(function(e){return e.theme.drawerMinWidth}),(function(e){return e.theme.primary.contrastText})),Pt=Object(D.b)(Tn.a)(We||(We=Object(l.a)(["\n  .MuiDrawer-paper {\n    background-color: "," !important;\n    color: "," !important;\n    overflow-x: hidden;\n  }\n"])),(function(e){return e.theme.primary.light}),(function(e){return e.theme.primary.contrastText})),Et=function(e){var n,t,r=e.gestureDirection,o=e.contextProps,c=Un(),l=a.a.useState(!1),u=Object(s.a)(l,2),d=u[0],p=u[1],b=a.a.useState(!1),f=Object(s.a)(b,2),h=f[0],j=f[1],m=a.a.useState(!1),O=Object(s.a)(m,2),g=O[0],x=O[1];a.a.useEffect((function(){"left"===r&&p(!1),"right"===r&&p(!0),r||p(!1)}),[r]);return Object(K.jsxs)(Pt,{variant:"permanent",className:Object(Sn.a)(c.drawer,(n={},Object(Ze.a)(n,c.drawerOpen,d),Object(Ze.a)(n,c.drawerClose,!d),n)),classes:{paper:Object(Sn.a)((t={},Object(Ze.a)(t,c.drawerOpen,d),Object(Ze.a)(t,c.drawerClose,!d),t))},children:[Object(K.jsxs)("div",{className:c.titleBar,children:[d&&Object(K.jsx)("div",{className:c.titleText,children:"PeerTransfer"}),Object(K.jsx)(Mn.a,{title:d?"Close Menu":"Open Menu",placement:"right",children:Object(K.jsx)(At,{disableRipple:!0,onClick:function(){return p((function(e){return!e}))},children:d?Object(K.jsx)(Fn.a,{}):Object(K.jsx)(Ln.a,{})})})]}),Object(K.jsx)(An.a,{}),Object(K.jsx)(Ot,Object(i.a)({drawerOpen:d,handleJoinRoomModalOpen:function(){return j(!0)},handleAboutModalOpen:function(){return x(!0)}},o)),Object(K.jsx)(It,{open:h,handleClose:function(){return j(!1)}}),Object(K.jsx)(Tt,{open:g,handleClose:function(){return x(!1)}})]})},Ft=function(e){return Object(K.jsx)(sn.Consumer,{children:function(n){return Object(K.jsx)(Et,Object(i.a)(Object(i.a)({},e),{},{contextProps:n}))}})},Mt=Object(D.b)(T.a)(He||(He=Object(l.a)([""]))),zt=D.b.div($e||($e=Object(l.a)(["\n  position: absolute;\n  bottom: 0;\n  background-image: url(",");\n  background-repeat: no-repeat;\n  background-position: bottom;\n  background-size: cover;\n  width: 100%;\n  height: 100%;\n  max-height: 1600px;\n"])),A),Lt=D.b.div(Je||(Je=Object(l.a)(["\n  position: relative;\n  background-color: ",";\n  height: 100%;\n  min-height: 100%;\n  max-width: 100vw;\n  overflow-x: hidden;\n  overflow-y: hidden;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  justify-content: center;\n  font-size: calc(10px + 2vmin);\n  color: white;\n"])),(function(e){return e.theme.primary.main})),Bt=Object(D.b)(Lt)(Ge||(Ge=Object(l.a)(["\n  margin-left: ",";\n  z-index: 10;\n  p,\n  button,\n  label {\n    z-index: 1;\n  }\n"])),(function(e){return e.theme.drawerMinWidth})),_t=function(e){var n=e.publicID,t=e.localID,a=Object(r.useState)(),o=Object(s.a)(a,2),c=o[0],l=o[1],u=Object(r.useState)(),d=Object(s.a)(u,2),p=d[0],b=d[1];Object(r.useEffect)((function(){!function(){var e=k.database(),r=Object(i.a)({id:t,emoji:"".concat(I())},S()),a=e.ref("".concat(n,"/").concat(t));a.set(r),a.onDisconnect().remove(),l(r)}()}),[t,n]),Object(r.useLayoutEffect)((function(){sessionStorage.getItem(U)&&(Object(E.b)(Object(K.jsx)("div",{children:"Failed to establish data transfer channel, please try again"}),{autoClose:!1,type:"warning"}),sessionStorage.removeItem(U))}),[]);var f=Object(P.a)({onDragEnd:function(e){if(e.event.target!==document.getElementById(X)&&e.event.target!==document.getElementById(q)){var n=Math.sign(e.movement[0]),t=Math.sign(e.movement[1]);Math.abs(e.movement[0])>8&&(-1===n&&b("left"),1===n&&b("right")),0===n&&0===t&&b(void 0)}}});return Object(K.jsxs)(Bt,Object(i.a)(Object(i.a)({},f()),{},{children:[Object(K.jsx)(Ft,{gestureDirection:p}),Object(K.jsx)(Rn,{selfIdentity:c,publicID:n,localID:t}),Object(K.jsx)(zt,{})]}))},Nt=function(){return Object(K.jsx)(Q.Consumer,{children:function(e){var n=e.localID,t=e.publicID;return n&&t?Object(K.jsx)(_t,{localID:n,publicID:t}):Object(K.jsx)(Lt,{children:Object(K.jsx)(Mt,{color:"secondary"})})}})},Ut=t(117),Wt=["className"],Ht=Object(D.b)((function(e){var n=e.className,t=Object(Ut.a)(e,Wt);return Object(K.jsx)("div",{className:n,children:Object(K.jsx)(E.a,Object(i.a)({},t))})})).attrs({})(Ye||(Ye=Object(l.a)(["\n  .Toastify__toast-container {\n    width: max-content;\n    max-width: 80vw;\n  }\n  .Toastify__toast-body {\n    font-family: 'Roboto', sans-serif;\n    white-space: pre-line;\n    min-width: 200px;\n  }\n"]))),$t=t(216),Jt=t(114),Gt=(t(151),t(152),function(e){var n=e.appTheme,t=Object(Jt.a)({palette:{primary:{main:_n[n].primary.main,dark:_n[n].primary.dark},secondary:{main:_n[n].secondary.main}}});return Object(K.jsx)(D.a,{theme:Object(i.a)(Object(i.a)({},Nn),_n[n]),children:Object(K.jsxs)($t.a,{theme:t,children:[Object(K.jsx)(Nt,{}),Object(K.jsx)(Ht,{position:"top-right",autoClose:5e3,pauseOnFocusLoss:!1,newestOnTop:!1,closeOnClick:!0,hideProgressBar:!0,rtl:!1,draggable:!0})]})})}),Yt=function(){return Object(K.jsx)(V,{children:Object(K.jsx)(ln,{children:Object(K.jsx)(sn.Consumer,{children:function(e){var n=e.appTheme;return Object(K.jsx)(Gt,{appTheme:n})}})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Xt=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,223)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,o=n.getLCP,c=n.getTTFB;t(e),r(e),a(e),o(e),c(e)}))};c.a.render(Object(K.jsx)(a.a.StrictMode,{children:Object(K.jsx)(Yt,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),Xt()}},[[153,1,2]]]);
//# sourceMappingURL=main.3e544a17.chunk.js.map